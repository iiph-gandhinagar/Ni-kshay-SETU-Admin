!function(e, t) {
    "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t((e = e || self).g1 = e.g1 || {})
}(this, function(e) {
    "use strict";
    function h(e, t) {
        if (!t)
            return e;
        var n = {};
        for (var r in e) {
            var a = r.split(":");
            1 == a.length ? n[a[0]] = e[r] : a[0] === t && (n[a[1]] = e[r])
        }
        return n
    }
    var m = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    }
    : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    }
      , v = {
        null: {
            null: {
                state: "null"
            },
            date: {
                state: "date"
            },
            number: {
                state: "number"
            },
            boolean: {
                state: "boolean"
            },
            string: {
                state: "string"
            },
            object: {
                state: "object"
            },
            mixed: {
                state: "mixed",
                end: !0
            }
        },
        date: {
            null: {
                state: "date"
            },
            undefined: {
                state: "date"
            },
            date: {
                state: "date"
            },
            default: {
                state: "mixed",
                end: !0
            }
        },
        number: {
            null: {
                state: "number"
            },
            undefined: {
                state: "number"
            },
            number: {
                state: "number"
            },
            default: {
                state: "mixed",
                end: !0
            }
        },
        boolean: {
            null: {
                state: "boolean"
            },
            undefined: {
                state: "boolean"
            },
            boolean: {
                state: "boolean"
            },
            default: {
                state: "mixed",
                end: !0
            }
        },
        string: {
            null: {
                state: "string"
            },
            undefined: {
                state: "string"
            },
            string: {
                state: "string"
            },
            default: {
                state: "mixed",
                end: !0
            }
        },
        object: {
            null: {
                state: "object"
            },
            object: {
                state: "object"
            },
            undefined: {
                state: "object"
            },
            default: {
                state: "mixed",
                end: !0
            }
        },
        mixed: {
            default: {
                state: "mixed",
                end: !0
            }
        }
    };
    function g(e, t) {
        var n = {};
        if (!e || !e.length)
            return n;
        (t = t || {}).convert = t.convert || !1,
        t.limit = t.limit || 1e3;
        for (var r = t.limit < e.length ? t.limit : e.length, a = t.ignore = t.ignore || [null, void 0], o = Object.keys(e[0]), i = 0; i < o.length; i++) {
            for (var l = o[i], s = "null", c = 0; c < r; c++) {
                var u = e[c]
                  , f = u[l];
                if (0 == i && Object.keys(e[c]).forEach(function(e) {
                    -1 == o.indexOf(e) && o.push(e)
                }),
                l in u && !(0 <= a.indexOf(f))) {
                    var d = void 0 === f ? "undefined" : m(f);
                    null == f ? d = "null" : "object" != d || isNaN(Date.parse(f)) ? t.convert && (!isNaN(parseFloat(f)) && isFinite(f) || 0 <= ["NaN", "Infinity", "-Infinity"].indexOf(f) ? d = "number" : isNaN(Date.parse(f)) ? -1 != ["true", "false"].indexOf(f) && (d = "boolean") : d = "date") : d = "date";
                    var p = v[d]
                      , h = p[s] || p.default;
                    if (s = h.state,
                    h.end)
                        break
                }
            }
            n[l] = s
        }
        return n
    }
    function n(e, t, n) {
        return e ? -1 != e.indexOf(t) ? !n : n : n ? null == t : null != t
    }
    function r(e, t, n) {
        return isNaN(t) && Date.parse(t) && (t = Date.parse(t)),
        isNaN(e) && Date.parse(e) && (e = Date.parse(e)),
        n ? e <= t : e < t
    }
    var b = {
        "=": function(e, t) {
            return n(e, t, !1)
        },
        "!": function(e, t) {
            return n(e, t, !0)
        },
        ">": function(e, t) {
            return r(e, t, !1)
        },
        "<": function(e, t) {
            return r(t, e, !1)
        },
        ">~": function(e, t) {
            return r(e, t, !0)
        },
        "<~": function(e, t) {
            return r(t, e, !0)
        },
        "~": function(e, t) {
            return n(t, e[0], !1)
        },
        "!~": function(e, t) {
            return n(t, e[0], !0)
        }
    }
      , y = {
        string: function(e, t, n) {
            return "desc" == (n = n || "asc") && (e = [t, t = e][0]),
            e.localeCompare(t)
        },
        number: function(e, t, n) {
            return "desc" == (n = n || "asc") && (e = [t, t = e][0]),
            e - t
        }
    };
    function u(e, t, n) {
        var r, a, o = e;
        t = h(t = t || [], n);
        var i = g(e, {
            convert: !0
        });
        for (var l in t)
            if ("_" != l[0]) {
                var s = l.match(/(!|>|>~|<|<~|~|!~)$/) ? l.match(/(!|>|>~|<|<~|~|!~)$/).index : l.length;
                r = "" != l.slice(s) ? l.slice(s) : "=",
                a = "" != t[l][0] ? t[l] : null;
                var c = l.slice(0, s);
                "number" == i[c] ? a = a.map(function(e) {
                    return parseFloat(e)
                }) : "boolean" == i[c] ? a = a.map(function(e) {
                    return "true" == String(e)
                }) : "date" == i[c] && (a = a.map(function(e) {
                    return Date.parse(e)
                })),
                o = o.filter(function(e) {
                    return void 0 === e[c] || b[r](a, e[c])
                })
            }
        var u = parseInt(t._offset) || 0
          , f = parseInt(t._limit) || 1e3;
        if (o = o.slice(u, u + f),
        t._c) {
            var d = []
              , p = [];
            t._c.forEach(function(e) {
                "-" == e[0] ? d.push(e.slice(1)) : p.push(e)
            }),
            o = o.map(function(e) {
                return function(t, e, n) {
                    0 == e.length && (e = Object.keys(t));
                    var r = {};
                    return e.forEach(function(e) {
                        n.indexOf(e) < 0 && (r[e] = t[e])
                    }),
                    r
                }(e, p, d)
            })
        }
        return t._sort && o.sort(function(r, a) {
            var o = !1;
            return t._sort.forEach(function(e) {
                var t = "-" == e[0] ? "desc" : "asc";
                if ("-" == e[0] && (e = e.substr(1)),
                void 0 !== r[e]) {
                    var n = isNaN(r[e]) ? "string" : "number";
                    o = o || y[n](r[e], a[e], t)
                }
            }),
            o
        }),
        o
    }
    var t = "object" == ("undefined" == typeof global ? "undefined" : m(global)) && global && global.Object === Object && global
      , a = "object" == ("undefined" == typeof self ? "undefined" : m(self)) && self && self.Object === Object && self
      , o = t || a || Function("return this")()
      , i = o.Symbol
      , l = Object.prototype
      , s = l.hasOwnProperty
      , c = l.toString
      , f = i ? i.toStringTag : void 0;
    var d = Object.prototype.toString;
    var p = "[object Null]"
      , j = "[object Undefined]"
      , w = i ? i.toStringTag : void 0;
    function x(e) {
        return null == e ? void 0 === e ? j : p : w && w in Object(e) ? function(e) {
            var t = s.call(e, f)
              , n = e[f];
            try {
                var r = !(e[f] = void 0)
            } catch (e) {}
            var a = c.call(e);
            return r && (t ? e[f] = n : delete e[f]),
            a
        }(e) : function(e) {
            return d.call(e)
        }(e)
    }
    function k(e) {
        var t = void 0 === e ? "undefined" : m(e);
        return null != e && ("object" == t || "function" == t)
    }
    var O = "[object AsyncFunction]"
      , E = "[object Function]"
      , A = "[object GeneratorFunction]"
      , S = "[object Proxy]";
    function C(e) {
        if (!k(e))
            return !1;
        var t = x(e);
        return t == E || t == A || t == O || t == S
    }
    var I, z = o["__core-js_shared__"], q = (I = /[^.]+$/.exec(z && z.keys && z.keys.IE_PROTO || "")) ? "Symbol(src)_1." + I : "";
    var M = Function.prototype.toString;
    function T(e) {
        if (null != e) {
            try {
                return M.call(e)
            } catch (e) {}
            try {
                return e + ""
            } catch (e) {}
        }
        return ""
    }
    var N = /^\[object .+?Constructor\]$/
      , P = Function.prototype
      , D = Object.prototype
      , Q = P.toString
      , R = D.hasOwnProperty
      , U = RegExp("^" + Q.call(R).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");
    function F(e) {
        return !(!k(e) || function(e) {
            return !!q && q in e
        }(e)) && (C(e) ? U : N).test(T(e))
    }
    function B(e, t) {
        var n = function(e, t) {
            return null == e ? void 0 : e[t]
        }(e, t);
        return F(n) ? n : void 0
    }
    var V = B(Object, "create");
    var W = Object.prototype.hasOwnProperty;
    var H = Object.prototype.hasOwnProperty;
    function J(e) {
        var t = -1
          , n = null == e ? 0 : e.length;
        for (this.clear(); ++t < n; ) {
            var r = e[t];
            this.set(r[0], r[1])
        }
    }
    function G(e, t) {
        return e === t || e != e && t != t
    }
    function K(e, t) {
        for (var n = e.length; n--; )
            if (G(e[n][0], t))
                return n;
        return -1
    }
    J.prototype.clear = function() {
        this.__data__ = V ? V(null) : {},
        this.size = 0
    }
    ,
    J.prototype.delete = function(e) {
        var t = this.has(e) && delete this.__data__[e];
        return this.size -= t ? 1 : 0,
        t
    }
    ,
    J.prototype.get = function(e) {
        var t = this.__data__;
        if (V) {
            var n = t[e];
            return "__lodash_hash_undefined__" === n ? void 0 : n
        }
        return W.call(t, e) ? t[e] : void 0
    }
    ,
    J.prototype.has = function(e) {
        var t = this.__data__;
        return V ? void 0 !== t[e] : H.call(t, e)
    }
    ,
    J.prototype.set = function(e, t) {
        var n = this.__data__;
        return this.size += this.has(e) ? 0 : 1,
        n[e] = V && void 0 === t ? "__lodash_hash_undefined__" : t,
        this
    }
    ;
    var X = Array.prototype.splice;
    function Y(e) {
        var t = -1
          , n = null == e ? 0 : e.length;
        for (this.clear(); ++t < n; ) {
            var r = e[t];
            this.set(r[0], r[1])
        }
    }
    Y.prototype.clear = function() {
        this.__data__ = [],
        this.size = 0
    }
    ,
    Y.prototype.delete = function(e) {
        var t = this.__data__
          , n = K(t, e);
        return !(n < 0) && (n == t.length - 1 ? t.pop() : X.call(t, n, 1),
        --this.size,
        !0)
    }
    ,
    Y.prototype.get = function(e) {
        var t = this.__data__
          , n = K(t, e);
        return n < 0 ? void 0 : t[n][1]
    }
    ,
    Y.prototype.has = function(e) {
        return -1 < K(this.__data__, e)
    }
    ,
    Y.prototype.set = function(e, t) {
        var n = this.__data__
          , r = K(n, e);
        return r < 0 ? (++this.size,
        n.push([e, t])) : n[r][1] = t,
        this
    }
    ;
    var Z = B(o, "Map");
    function ee(e, t) {
        var n = e.__data__;
        return function(e) {
            var t = void 0 === e ? "undefined" : m(e);
            return "string" == t || "number" == t || "symbol" == t || "boolean" == t ? "__proto__" !== e : null === e
        }(t) ? n["string" == typeof t ? "string" : "hash"] : n.map
    }
    function te(e) {
        var t = -1
          , n = null == e ? 0 : e.length;
        for (this.clear(); ++t < n; ) {
            var r = e[t];
            this.set(r[0], r[1])
        }
    }
    te.prototype.clear = function() {
        this.size = 0,
        this.__data__ = {
            hash: new J,
            map: new (Z || Y),
            string: new J
        }
    }
    ,
    te.prototype.delete = function(e) {
        var t = ee(this, e).delete(e);
        return this.size -= t ? 1 : 0,
        t
    }
    ,
    te.prototype.get = function(e) {
        return ee(this, e).get(e)
    }
    ,
    te.prototype.has = function(e) {
        return ee(this, e).has(e)
    }
    ,
    te.prototype.set = function(e, t) {
        var n = ee(this, e)
          , r = n.size;
        return n.set(e, t),
        this.size += n.size == r ? 0 : 1,
        this
    }
    ;
    function ne(e) {
        var t = -1
          , n = null == e ? 0 : e.length;
        for (this.__data__ = new te; ++t < n; )
            this.add(e[t])
    }
    function re(e) {
        return e != e
    }
    function ae(e, t) {
        return !!(null == e ? 0 : e.length) && -1 < function(e, t, n) {
            return t == t ? function(e, t, n) {
                for (var r = n - 1, a = e.length; ++r < a; )
                    if (e[r] === t)
                        return r;
                return -1
            }(e, t, n) : function(e, t, n, r) {
                for (var a = e.length, o = n + (r ? 1 : -1); r ? o-- : ++o < a; )
                    if (t(e[o], o, e))
                        return o;
                return -1
            }(e, re, n)
        }(e, t, 0)
    }
    function oe(e, t, n) {
        for (var r = -1, a = null == e ? 0 : e.length; ++r < a; )
            if (n(t, e[r]))
                return !0;
        return !1
    }
    function ie(e, t) {
        return e.has(t)
    }
    ne.prototype.add = ne.prototype.push = function(e) {
        return this.__data__.set(e, "__lodash_hash_undefined__"),
        this
    }
    ,
    ne.prototype.has = function(e) {
        return this.__data__.has(e)
    }
    ;
    var le = B(o, "Set");
    function se(e) {
        var t = -1
          , n = Array(e.size);
        return e.forEach(function(e) {
            n[++t] = e
        }),
        n
    }
    var ce = le && 1 / se(new le([, -0]))[1] == 1 / 0 ? function(e) {
        return new le(e)
    }
    : function() {}
      , ue = 200;
    function fe(e, t, n) {
        var r = e.length;
        return n = void 0 === n ? r : n,
        !t && r <= n ? e : function(e, t, n) {
            var r = -1
              , a = e.length;
            t < 0 && (t = a < -t ? 0 : a + t),
            (n = a < n ? a : n) < 0 && (n += a),
            a = n < t ? 0 : n - t >>> 0,
            t >>>= 0;
            for (var o = Array(a); ++r < a; )
                o[r] = e[r + t];
            return o
        }(e, t, n)
    }
    var de = RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");
    function pe(e) {
        return de.test(e)
    }
    var he = "\\ud800-\\udfff"
      , me = "[" + he + "]"
      , ve = "[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]"
      , ge = "\\ud83c[\\udffb-\\udfff]"
      , be = "[^" + he + "]"
      , ye = "(?:\\ud83c[\\udde6-\\uddff]){2}"
      , _e = "[\\ud800-\\udbff][\\udc00-\\udfff]"
      , je = "(?:" + ve + "|" + ge + ")" + "?"
      , we = "[\\ufe0e\\ufe0f]?"
      , xe = we + je + ("(?:\\u200d(?:" + [be, ye, _e].join("|") + ")" + we + je + ")*")
      , $e = "(?:" + [be + ve + "?", ve, ye, _e, me].join("|") + ")"
      , ke = RegExp(ge + "(?=" + ge + ")|" + $e + xe, "g");
    function Oe(e) {
        return pe(e) ? function(e) {
            return e.match(ke) || []
        }(e) : function(e) {
            return e.split("")
        }(e)
    }
    var Ee = Array.isArray;
    function Ae(e) {
        return null != e && "object" == (void 0 === e ? "undefined" : m(e))
    }
    var Se = "[object Symbol]";
    function Ce(e) {
        return "symbol" == (void 0 === e ? "undefined" : m(e)) || Ae(e) && x(e) == Se
    }
    var Ie = 1 / 0
      , ze = i ? i.prototype : void 0
      , qe = ze ? ze.toString : void 0;
    function Me(e) {
        if ("string" == typeof e)
            return e;
        if (Ee(e))
            return function(e, t) {
                for (var n = -1, r = null == e ? 0 : e.length, a = Array(r); ++n < r; )
                    a[n] = t(e[n], n, e);
                return a
            }(e, Me) + "";
        if (Ce(e))
            return qe ? qe.call(e) : "";
        var t = e + "";
        return "0" == t && 1 / e == -Ie ? "-0" : t
    }
    function Te(e) {
        return null == e ? "" : Me(e)
    }
    var Ne, Le = (Ne = "toUpperCase",
    function(e) {
        var t = pe(e = Te(e)) ? Oe(e) : void 0
          , n = t ? t[0] : e.charAt(0)
          , r = t ? fe(t, 1).join("") : e.slice(1);
        return n[Ne]() + r
    }
    );
    function Pe(e) {
        var t = this.__data__ = new Y(e);
        this.size = t.size
    }
    Pe.prototype.clear = function() {
        this.__data__ = new Y,
        this.size = 0
    }
    ,
    Pe.prototype.delete = function(e) {
        var t = this.__data__
          , n = t.delete(e);
        return this.size = t.size,
        n
    }
    ,
    Pe.prototype.get = function(e) {
        return this.__data__.get(e)
    }
    ,
    Pe.prototype.has = function(e) {
        return this.__data__.has(e)
    }
    ,
    Pe.prototype.set = function(e, t) {
        var n = this.__data__;
        if (n instanceof Y) {
            var r = n.__data__;
            if (!Z || r.length < 199)
                return r.push([e, t]),
                this.size = ++n.size,
                this;
            n = this.__data__ = new te(r)
        }
        return n.set(e, t),
        this.size = n.size,
        this
    }
    ;
    var De = function() {
        try {
            var e = B(Object, "defineProperty");
            return e({}, "", {}),
            e
        } catch (e) {}
    }();
    function Qe(e, t, n) {
        "__proto__" == t && De ? De(e, t, {
            configurable: !0,
            enumerable: !0,
            value: n,
            writable: !0
        }) : e[t] = n
    }
    var Re = Object.prototype.hasOwnProperty;
    function Ue(e, t, n) {
        var r = e[t];
        Re.call(e, t) && G(r, n) && (void 0 !== n || t in e) || Qe(e, t, n)
    }
    function Fe(e, t, n, r) {
        var a = !n;
        n = n || {};
        for (var o = -1, i = t.length; ++o < i; ) {
            var l = t[o]
              , s = r ? r(n[l], e[l], l, n, e) : void 0;
            void 0 === s && (s = e[l]),
            a ? Qe(n, l, s) : Ue(n, l, s)
        }
        return n
    }
    function Be(e) {
        return Ae(e) && "[object Arguments]" == x(e)
    }
    var Ve = Object.prototype
      , We = Ve.hasOwnProperty
      , He = Ve.propertyIsEnumerable
      , Je = Be(function() {
        return arguments
    }()) ? Be : function(e) {
        return Ae(e) && We.call(e, "callee") && !He.call(e, "callee")
    }
    ;
    var Ge = "object" == (void 0 === e ? "undefined" : m(e)) && e && !e.nodeType && e
      , Ke = Ge && "object" == ("undefined" == typeof module ? "undefined" : m(module)) && module && !module.nodeType && module
      , Xe = Ke && Ke.exports === Ge ? o.Buffer : void 0
      , Ye = (Xe ? Xe.isBuffer : void 0) || function() {
        return !1
    }
      , Ze = 9007199254740991
      , et = /^(?:0|[1-9]\d*)$/;
    function tt(e, t) {
        var n = void 0 === e ? "undefined" : m(e);
        return !!(t = null == t ? Ze : t) && ("number" == n || "symbol" != n && et.test(e)) && -1 < e && e % 1 == 0 && e < t
    }
    var nt = 9007199254740991;
    function rt(e) {
        return "number" == typeof e && -1 < e && e % 1 == 0 && e <= nt
    }
    var at = {};
    function ot(t) {
        return function(e) {
            return t(e)
        }
    }
    at["[object Float32Array]"] = at["[object Float64Array]"] = at["[object Int8Array]"] = at["[object Int16Array]"] = at["[object Int32Array]"] = at["[object Uint8Array]"] = at["[object Uint8ClampedArray]"] = at["[object Uint16Array]"] = at["[object Uint32Array]"] = !0,
    at["[object Arguments]"] = at["[object Array]"] = at["[object ArrayBuffer]"] = at["[object Boolean]"] = at["[object DataView]"] = at["[object Date]"] = at["[object Error]"] = at["[object Function]"] = at["[object Map]"] = at["[object Number]"] = at["[object Object]"] = at["[object RegExp]"] = at["[object Set]"] = at["[object String]"] = at["[object WeakMap]"] = !1;
    var it = "object" == (void 0 === e ? "undefined" : m(e)) && e && !e.nodeType && e
      , lt = it && "object" == ("undefined" == typeof module ? "undefined" : m(module)) && module && !module.nodeType && module
      , st = lt && lt.exports === it && t.process
      , ct = function() {
        try {
            var e = lt && lt.require && lt.require("util").types;
            return e || st && st.binding && st.binding("util")
        } catch (e) {}
    }()
      , ut = ct && ct.isTypedArray
      , ft = ut ? ot(ut) : function(e) {
        return Ae(e) && rt(e.length) && !!at[x(e)]
    }
      , dt = Object.prototype.hasOwnProperty;
    function pt(e, t) {
        var n = Ee(e)
          , r = !n && Je(e)
          , a = !n && !r && Ye(e)
          , o = !n && !r && !a && ft(e)
          , i = n || r || a || o
          , l = i ? function(e, t) {
            for (var n = -1, r = Array(e); ++n < e; )
                r[n] = t(n);
            return r
        }(e.length, String) : []
          , s = l.length;
        for (var c in e)
            !t && !dt.call(e, c) || i && ("length" == c || a && ("offset" == c || "parent" == c) || o && ("buffer" == c || "byteLength" == c || "byteOffset" == c) || tt(c, s)) || l.push(c);
        return l
    }
    var ht = Object.prototype;
    function mt(e) {
        var t = e && e.constructor;
        return e === ("function" == typeof t && t.prototype || ht)
    }
    function vt(t, n) {
        return function(e) {
            return t(n(e))
        }
    }
    var gt = vt(Object.keys, Object)
      , bt = Object.prototype.hasOwnProperty;
    function yt(e) {
        return null != e && rt(e.length) && !C(e)
    }
    function _t(e) {
        return yt(e) ? pt(e) : function(e) {
            if (!mt(e))
                return gt(e);
            var t = [];
            for (var n in Object(e))
                bt.call(e, n) && "constructor" != n && t.push(n);
            return t
        }(e)
    }
    var jt = Object.prototype.hasOwnProperty;
    function wt(e) {
        if (!k(e))
            return function(e) {
                var t = [];
                if (null != e)
                    for (var n in Object(e))
                        t.push(n);
                return t
            }(e);
        var t = mt(e)
          , n = [];
        for (var r in e)
            ("constructor" != r || !t && jt.call(e, r)) && n.push(r);
        return n
    }
    function xt(e) {
        return yt(e) ? pt(e, !0) : wt(e)
    }
    var $t = "object" == (void 0 === e ? "undefined" : m(e)) && e && !e.nodeType && e
      , kt = $t && "object" == ("undefined" == typeof module ? "undefined" : m(module)) && module && !module.nodeType && module
      , Ot = kt && kt.exports === $t ? o.Buffer : void 0
      , Et = Ot ? Ot.allocUnsafe : void 0;
    function At() {
        return []
    }
    var St = Object.prototype.propertyIsEnumerable
      , Ct = Object.getOwnPropertySymbols
      , It = Ct ? function(t) {
        return null == t ? [] : (t = Object(t),
        function(e, t) {
            for (var n = -1, r = null == e ? 0 : e.length, a = 0, o = []; ++n < r; ) {
                var i = e[n];
                t(i, n, e) && (o[a++] = i)
            }
            return o
        }(Ct(t), function(e) {
            return St.call(t, e)
        }))
    }
    : At;
    function zt(e, t) {
        for (var n = -1, r = t.length, a = e.length; ++n < r; )
            e[a + n] = t[n];
        return e
    }
    var qt = vt(Object.getPrototypeOf, Object)
      , Mt = Object.getOwnPropertySymbols ? function(e) {
        for (var t = []; e; )
            zt(t, It(e)),
            e = qt(e);
        return t
    }
    : At;
    function Tt(e, t, n) {
        var r = t(e);
        return Ee(e) ? r : zt(r, n(e))
    }
    function Nt(e) {
        return Tt(e, _t, It)
    }
    function Lt(e) {
        return Tt(e, xt, Mt)
    }
    var Pt = B(o, "DataView")
      , Dt = B(o, "Promise")
      , Qt = B(o, "WeakMap")
      , Rt = "[object Map]"
      , Ut = "[object Promise]"
      , Ft = "[object Set]"
      , Bt = "[object WeakMap]"
      , Vt = "[object DataView]"
      , Wt = T(Pt)
      , Ht = T(Z)
      , Jt = T(Dt)
      , Gt = T(le)
      , Kt = T(Qt)
      , Xt = x;
    (Pt && Xt(new Pt(new ArrayBuffer(1))) != Vt || Z && Xt(new Z) != Rt || Dt && Xt(Dt.resolve()) != Ut || le && Xt(new le) != Ft || Qt && Xt(new Qt) != Bt) && (Xt = function(e) {
        var t = x(e)
          , n = "[object Object]" == t ? e.constructor : void 0
          , r = n ? T(n) : "";
        if (r)
            switch (r) {
            case Wt:
                return Vt;
            case Ht:
                return Rt;
            case Jt:
                return Ut;
            case Gt:
                return Ft;
            case Kt:
                return Bt
            }
        return t
    }
    );
    var Yt = Xt
      , Zt = Object.prototype.hasOwnProperty;
    var en = o.Uint8Array;
    function tn(e) {
        var t = new e.constructor(e.byteLength);
        return new en(t).set(new en(e)),
        t
    }
    var nn = /\w*$/;
    var rn = i ? i.prototype : void 0
      , an = rn ? rn.valueOf : void 0;
    var on = "[object Boolean]"
      , ln = "[object Date]"
      , sn = "[object Map]"
      , cn = "[object Number]"
      , un = "[object RegExp]"
      , fn = "[object Set]"
      , dn = "[object String]"
      , pn = "[object Symbol]"
      , hn = "[object ArrayBuffer]"
      , mn = "[object DataView]"
      , vn = "[object Float32Array]"
      , gn = "[object Float64Array]"
      , bn = "[object Int8Array]"
      , yn = "[object Int16Array]"
      , _n = "[object Int32Array]"
      , jn = "[object Uint8Array]"
      , wn = "[object Uint8ClampedArray]"
      , xn = "[object Uint16Array]"
      , $n = "[object Uint32Array]";
    function kn(e, t, n) {
        var r = e.constructor;
        switch (t) {
        case hn:
            return tn(e);
        case on:
        case ln:
            return new r(+e);
        case mn:
            return function(e, t) {
                var n = t ? tn(e.buffer) : e.buffer;
                return new e.constructor(n,e.byteOffset,e.byteLength)
            }(e, n);
        case vn:
        case gn:
        case bn:
        case yn:
        case _n:
        case jn:
        case wn:
        case xn:
        case $n:
            return function(e, t) {
                var n = t ? tn(e.buffer) : e.buffer;
                return new e.constructor(n,e.byteOffset,e.length)
            }(e, n);
        case sn:
            return new r;
        case cn:
        case dn:
            return new r(e);
        case un:
            return function(e) {
                var t = new e.constructor(e.source,nn.exec(e));
                return t.lastIndex = e.lastIndex,
                t
            }(e);
        case fn:
            return new r;
        case pn:
            return function(e) {
                return an ? Object(an.call(e)) : {}
            }(e)
        }
    }
    var On = Object.create
      , En = function(e) {
        if (!k(e))
            return {};
        if (On)
            return On(e);
        An.prototype = e;
        var t = new An;
        return An.prototype = void 0,
        t
    };
    function An() {}
    var Sn = ct && ct.isMap
      , Cn = Sn ? ot(Sn) : function(e) {
        return Ae(e) && "[object Map]" == Yt(e)
    }
    ;
    var In = ct && ct.isSet
      , zn = In ? ot(In) : function(e) {
        return Ae(e) && "[object Set]" == Yt(e)
    }
      , qn = 1
      , Mn = 2
      , Tn = 4
      , Nn = "[object Arguments]"
      , Ln = "[object Function]"
      , Pn = "[object GeneratorFunction]"
      , Dn = "[object Object]"
      , Qn = {};
    function Rn(n, r, a, e, t, o) {
        var i, l = r & qn, s = r & Mn, c = r & Tn;
        if (a && (i = t ? a(n, e, t, o) : a(n)),
        void 0 !== i)
            return i;
        if (!k(n))
            return n;
        var u = Ee(n);
        if (u) {
            if (i = function(e) {
                var t = e.length
                  , n = new e.constructor(t);
                return t && "string" == typeof e[0] && Zt.call(e, "index") && (n.index = e.index,
                n.input = e.input),
                n
            }(n),
            !l)
                return function(e, t) {
                    var n = -1
                      , r = e.length;
                    for (t = t || Array(r); ++n < r; )
                        t[n] = e[n];
                    return t
                }(n, i)
        } else {
            var f = Yt(n)
              , d = f == Ln || f == Pn;
            if (Ye(n))
                return function(e, t) {
                    if (t)
                        return e.slice();
                    var n = e.length
                      , r = Et ? Et(n) : new e.constructor(n);
                    return e.copy(r),
                    r
                }(n, l);
            if (f == Dn || f == Nn || d && !t) {
                if (i = s || d ? {} : function(e) {
                    return "function" != typeof e.constructor || mt(e) ? {} : En(qt(e))
                }(n),
                !l)
                    return s ? function(e, t) {
                        return Fe(e, Mt(e), t)
                    }(n, function(e, t) {
                        return e && Fe(t, xt(t), e)
                    }(i, n)) : function(e, t) {
                        return Fe(e, It(e), t)
                    }(n, function(e, t) {
                        return e && Fe(t, _t(t), e)
                    }(i, n))
            } else {
                if (!Qn[f])
                    return t ? n : {};
                i = kn(n, f, l)
            }
        }
        var p = (o = o || new Pe).get(n);
        if (p)
            return p;
        o.set(n, i),
        zn(n) ? n.forEach(function(e) {
            i.add(Rn(e, r, a, e, n, o))
        }) : Cn(n) && n.forEach(function(e, t) {
            i.set(t, Rn(e, r, a, t, n, o))
        });
        var h = c ? s ? Lt : Nt : s ? keysIn : _t
          , m = u ? void 0 : h(n);
        return function(e, t) {
            for (var n = -1, r = null == e ? 0 : e.length; ++n < r && !1 !== t(e[n], n, e); )
                ;
        }(m || n, function(e, t) {
            m && (e = n[t = e]),
            Ue(i, t, Rn(e, r, a, t, n, o))
        }),
        i
    }
    function Un(e, t) {
        for (var n = -1, r = null == e ? 0 : e.length; ++n < r; )
            if (t(e[n], n, e))
                return !0;
        return !1
    }
    Qn[Nn] = Qn["[object Array]"] = Qn["[object ArrayBuffer]"] = Qn["[object DataView]"] = Qn["[object Boolean]"] = Qn["[object Date]"] = Qn["[object Float32Array]"] = Qn["[object Float64Array]"] = Qn["[object Int8Array]"] = Qn["[object Int16Array]"] = Qn["[object Int32Array]"] = Qn["[object Map]"] = Qn["[object Number]"] = Qn[Dn] = Qn["[object RegExp]"] = Qn["[object Set]"] = Qn["[object String]"] = Qn["[object Symbol]"] = Qn["[object Uint8Array]"] = Qn["[object Uint8ClampedArray]"] = Qn["[object Uint16Array]"] = Qn["[object Uint32Array]"] = !0,
    Qn["[object Error]"] = Qn[Ln] = Qn["[object WeakMap]"] = !1;
    var Fn = 1
      , Bn = 2;
    function Vn(e, t, n, r, a, o) {
        var i = n & Fn
          , l = e.length
          , s = t.length;
        if (l != s && !(i && l < s))
            return !1;
        var c = o.get(e);
        if (c && o.get(t))
            return c == t;
        var u = -1
          , f = !0
          , d = n & Bn ? new ne : void 0;
        for (o.set(e, t),
        o.set(t, e); ++u < l; ) {
            var p = e[u]
              , h = t[u];
            if (r)
                var m = i ? r(h, p, u, t, e, o) : r(p, h, u, e, t, o);
            if (void 0 !== m) {
                if (m)
                    continue;
                f = !1;
                break
            }
            if (d) {
                if (!Un(t, function(e, t) {
                    if (!ie(d, t) && (p === e || a(p, e, n, r, o)))
                        return d.push(t)
                })) {
                    f = !1;
                    break
                }
            } else if (p !== h && !a(p, h, n, r, o)) {
                f = !1;
                break
            }
        }
        return o.delete(e),
        o.delete(t),
        f
    }
    function Wn(e) {
        var n = -1
          , r = Array(e.size);
        return e.forEach(function(e, t) {
            r[++n] = [t, e]
        }),
        r
    }
    var Hn = 1
      , Jn = 2
      , Gn = "[object Boolean]"
      , Kn = "[object Date]"
      , Xn = "[object Error]"
      , Yn = "[object Map]"
      , Zn = "[object Number]"
      , er = "[object RegExp]"
      , tr = "[object Set]"
      , nr = "[object String]"
      , rr = "[object Symbol]"
      , ar = "[object ArrayBuffer]"
      , or = "[object DataView]"
      , ir = i ? i.prototype : void 0
      , lr = ir ? ir.valueOf : void 0;
    var sr = 1
      , cr = Object.prototype.hasOwnProperty;
    var ur = 1
      , fr = "[object Arguments]"
      , dr = "[object Array]"
      , pr = "[object Object]"
      , hr = Object.prototype.hasOwnProperty;
    function mr(e, t, n, r, a, o) {
        var i = Ee(e)
          , l = Ee(t)
          , s = i ? dr : Yt(e)
          , c = l ? dr : Yt(t)
          , u = (s = s == fr ? pr : s) == pr
          , f = (c = c == fr ? pr : c) == pr
          , d = s == c;
        if (d && Ye(e)) {
            if (!Ye(t))
                return !1;
            u = !(i = !0)
        }
        if (d && !u)
            return o = o || new Pe,
            i || ft(e) ? Vn(e, t, n, r, a, o) : function(e, t, n, r, a, o, i) {
                switch (n) {
                case or:
                    if (e.byteLength != t.byteLength || e.byteOffset != t.byteOffset)
                        return !1;
                    e = e.buffer,
                    t = t.buffer;
                case ar:
                    return !(e.byteLength != t.byteLength || !o(new en(e), new en(t)));
                case Gn:
                case Kn:
                case Zn:
                    return G(+e, +t);
                case Xn:
                    return e.name == t.name && e.message == t.message;
                case er:
                case nr:
                    return e == t + "";
                case Yn:
                    var l = Wn;
                case tr:
                    var s = r & Hn;
                    if (l = l || se,
                    e.size != t.size && !s)
                        return !1;
                    var c = i.get(e);
                    if (c)
                        return c == t;
                    r |= Jn,
                    i.set(e, t);
                    var u = Vn(l(e), l(t), r, a, o, i);
                    return i.delete(e),
                    u;
                case rr:
                    if (lr)
                        return lr.call(e) == lr.call(t)
                }
                return !1
            }(e, t, s, n, r, a, o);
        if (!(n & ur)) {
            var p = u && hr.call(e, "__wrapped__")
              , h = f && hr.call(t, "__wrapped__");
            if (p || h)
                return a(p ? e.value() : e, h ? t.value() : t, n, r, o = o || new Pe)
        }
        return d && function(e, t, n, r, a, o) {
            var i = n & sr
              , l = Nt(e)
              , s = l.length;
            if (s != Nt(t).length && !i)
                return !1;
            for (var c = s; c--; ) {
                var u = l[c];
                if (!(i ? u in t : cr.call(t, u)))
                    return !1
            }
            var f = o.get(e);
            if (f && o.get(t))
                return f == t;
            var d = !0;
            o.set(e, t),
            o.set(t, e);
            for (var p = i; ++c < s; ) {
                var h = e[u = l[c]]
                  , m = t[u];
                if (r)
                    var v = i ? r(m, h, u, t, e, o) : r(h, m, u, e, t, o);
                if (!(void 0 === v ? h === m || a(h, m, n, r, o) : v)) {
                    d = !1;
                    break
                }
                p = p || "constructor" == u
            }
            if (d && !p) {
                var g = e.constructor
                  , b = t.constructor;
                g != b && "constructor"in e && "constructor"in t && !("function" == typeof g && g instanceof g && "function" == typeof b && b instanceof b) && (d = !1)
            }
            return o.delete(e),
            o.delete(t),
            d
        }(e, t, n, r, a, o = o || new Pe)
    }
    function vr(e, t, n, r, a) {
        return e === t || (null == e || null == t || !Ae(e) && !Ae(t) ? e != e && t != t : mr(e, t, n, r, vr, a))
    }
    var gr = 1
      , br = 2;
    function yr(e) {
        return e == e && !k(e)
    }
    function _r(t, n) {
        return function(e) {
            return null != e && (e[t] === n && (void 0 !== n || t in Object(e)))
        }
    }
    function jr(t) {
        var n = function(e) {
            for (var t = _t(e), n = t.length; n--; ) {
                var r = t[n]
                  , a = e[r];
                t[n] = [r, a, yr(a)]
            }
            return t
        }(t);
        return 1 == n.length && n[0][2] ? _r(n[0][0], n[0][1]) : function(e) {
            return e === t || function(e, t, n, r) {
                var a = n.length
                  , o = a
                  , i = !r;
                if (null == e)
                    return !o;
                for (e = Object(e); a--; ) {
                    var l = n[a];
                    if (i && l[2] ? l[1] !== e[l[0]] : !(l[0]in e))
                        return !1
                }
                for (; ++a < o; ) {
                    var s = (l = n[a])[0]
                      , c = e[s]
                      , u = l[1];
                    if (i && l[2]) {
                        if (void 0 === c && !(s in e))
                            return !1
                    } else {
                        var f = new Pe;
                        if (r)
                            var d = r(c, u, s, e, t, f);
                        if (!(void 0 === d ? vr(u, c, gr | br, r, f) : d))
                            return !1
                    }
                }
                return !0
            }(e, t, n)
        }
    }
    var wr = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/
      , xr = /^\w*$/;
    function $r(e, t) {
        if (Ee(e))
            return !1;
        var n = void 0 === e ? "undefined" : m(e);
        return !("number" != n && "symbol" != n && "boolean" != n && null != e && !Ce(e)) || (xr.test(e) || !wr.test(e) || null != t && e in Object(t))
    }
    var kr = "Expected a function";
    function Or(a, o) {
        if ("function" != typeof a || null != o && "function" != typeof o)
            throw new TypeError(kr);
        function i() {
            var e = arguments
              , t = o ? o.apply(this, e) : e[0]
              , n = i.cache;
            if (n.has(t))
                return n.get(t);
            var r = a.apply(this, e);
            return i.cache = n.set(t, r) || n,
            r
        }
        return i.cache = new (Or.Cache || te),
        i
    }
    Or.Cache = te;
    var Er, Ar, Sr = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, Cr = /\\(\\)?/g, Ir = (Ar = (Er = Or(function(e) {
        var a = [];
        return 46 === e.charCodeAt(0) && a.push(""),
        e.replace(Sr, function(e, t, n, r) {
            a.push(n ? r.replace(Cr, "$1") : t || e)
        }),
        a
    }, function(e) {
        return 500 === Ar.size && Ar.clear(),
        e
    })).cache,
    Er);
    function zr(e, t) {
        return Ee(e) ? e : $r(e, t) ? [e] : Ir(Te(e))
    }
    var qr = 1 / 0;
    function Mr(e) {
        if ("string" == typeof e || Ce(e))
            return e;
        var t = e + "";
        return "0" == t && 1 / e == -qr ? "-0" : t
    }
    function Tr(e, t) {
        for (var n = 0, r = (t = zr(t, e)).length; null != e && n < r; )
            e = e[Mr(t[n++])];
        return n && n == r ? e : void 0
    }
    function Nr(e, t) {
        return null != e && t in Object(e)
    }
    function Lr(e, t) {
        return null != e && function(e, t, n) {
            for (var r = -1, a = (t = zr(t, e)).length, o = !1; ++r < a; ) {
                var i = Mr(t[r]);
                if (!(o = null != e && n(e, i)))
                    break;
                e = e[i]
            }
            return o || ++r != a ? o : !!(a = null == e ? 0 : e.length) && rt(a) && tt(i, a) && (Ee(e) || Je(e))
        }(e, t, Nr)
    }
    var Pr = 1
      , Dr = 2;
    function Qr(n, r) {
        return $r(n) && yr(r) ? _r(Mr(n), r) : function(e) {
            var t = function(e, t, n) {
                var r = null == e ? void 0 : Tr(e, t);
                return void 0 === r ? n : r
            }(e, n);
            return void 0 === t && t === r ? Lr(e, n) : vr(r, t, Pr | Dr)
        }
    }
    function Rr(e) {
        return e
    }
    function Ur(e) {
        return $r(e) ? function(t) {
            return function(e) {
                return null == e ? void 0 : e[t]
            }
        }(Mr(e)) : function(t) {
            return function(e) {
                return Tr(e, t)
            }
        }(e)
    }
    var Fr = 1;
    function Br(e) {
        return function(e) {
            return "function" == typeof e ? e : null == e ? Rr : "object" == (void 0 === e ? "undefined" : m(e)) ? Ee(e) ? Qr(e[0], e[1]) : jr(e) : Ur(e)
        }("function" == typeof e ? e : Rn(e, Fr))
    }
    function Vr(e, t) {
        return e < t ? -1 : t < e ? 1 : t <= e ? 0 : NaN
    }
    var Wr, Hr;
    1 === (Hr = Vr).length && (Wr = Hr,
    Hr = function(e, t) {
        return Vr(Wr(e), t)
    }
    );
    function Jr(e, t) {
        var n = void 0
          , r = void 0;
        if (void 0 === t) {
            var a = !0
              , o = !1
              , i = void 0;
            try {
                for (var l, s = e[Symbol.iterator](); !(a = (l = s.next()).done); a = !0) {
                    var c = l.value;
                    null != c && (void 0 === n ? c <= c && (n = r = c) : (c < n && (n = c),
                    r < c && (r = c)))
                }
            } catch (e) {
                o = !0,
                i = e
            } finally {
                try {
                    !a && s.return && s.return()
                } finally {
                    if (o)
                        throw i
                }
            }
        } else {
            var u = -1
              , f = !0
              , d = !1
              , p = void 0;
            try {
                for (var h, m = e[Symbol.iterator](); !(f = (h = m.next()).done); f = !0) {
                    var v = h.value;
                    null != (v = t(v, ++u, e)) && (void 0 === n ? v <= v && (n = r = v) : (v < n && (n = v),
                    r < v && (r = v)))
                }
            } catch (e) {
                d = !0,
                p = e
            } finally {
                try {
                    !f && m.return && m.return()
                } finally {
                    if (d)
                        throw p
                }
            }
        }
        return [n, r]
    }
    var Gr, Kr = {
        Ordinal: "discrete",
        Band: "discrete",
        Point: "discrete",
        Linear: "continuous",
        Log: "continuous",
        Pow: "continuous",
        Sqrt: "continuous",
        Sequential: "continuous",
        Quantile: "quantile",
        Quantize: "discretizing",
        Threshold: "discretizing"
    }, Xr = {
        Sequential: "Linear"
    }, Yr = {
        discrete: function(e) {
            return e && e.length ? function(e, t, n) {
                var r = -1
                  , a = ae
                  , o = e.length
                  , i = !0
                  , l = []
                  , s = l;
                if (n)
                    i = !1,
                    a = oe;
                else if (ue <= o) {
                    var c = t ? null : ce(e);
                    if (c)
                        return se(c);
                    i = !1,
                    a = ie,
                    s = new ne
                } else
                    s = t ? [] : l;
                e: for (; ++r < o; ) {
                    var u = e[r]
                      , f = t ? t(u) : u;
                    if (u = n || 0 !== u ? u : 0,
                    i && f == f) {
                        for (var d = s.length; d--; )
                            if (s[d] === f)
                                continue e;
                        t && s.push(f),
                        l.push(u)
                    } else
                        a(s, f, n) || (s !== l && s.push(f),
                        l.push(u))
                }
                return l
            }(e) : []
        },
        quantile: function(e) {
            return e
        },
        discretizing: Jr,
        continuous: Jr
    };
    function Zr(e, t) {
        return Array.isArray(e) ? e : "continuous" == Kr[t] ? [0, 1] : function(e, t) {
            return Object.values(e).length !== e.length ? e[t || e.length - 1] : e
        }(function(e) {
            return d3[e.startsWith("scheme") ? e : "scheme" + Le(e)]
        }(e.scheme), e.count)
    }
    function ea(e, t) {
        var n = Le(t.scale || "Linear");
        t = function(e, t) {
            return e.scheme && !Array.isArray(e.range) && (e.range = {
                scheme: e.scheme
            },
            "continuous" != Kr[t] && e.count && (e.range.count = e.count)),
            e.domain || (e.domain = {
                metric: e.metric
            }),
            e.metric = e.domain.metric || e.metric,
            e
        }(t, n);
        var r = d3["scale" + (Xr[n] || n)]().domain(function(e, t, n, r) {
            return Array.isArray(t) && "Quantile" != r ? t : Yr[Kr[r]](e.map(Br(n)))
        }(e, t.domain, t.metric, n)).range(function(e, t) {
            return t ? e.slice().reverse() : e
        }(Zr(t.range, n), !0 === t.range.reverse || t.reverse));
        return "continuous" != Kr[n] || Array.isArray(t.range) ? function(e) {
            return r("object" === (void 0 === e ? "undefined" : m(e)) ? Br(t.metric)(e) : e)
        }
        : function(e) {
            return d3["interpolate" + t.range.scheme](r("object" === (void 0 === e ? "undefined" : m(e)) ? Br(t.metric)(e) : e))
        }
    }
    var ta = 180 / Math.PI
      , na = {
        translateX: 0,
        translateY: 0
    };
    function ra(e) {
        return null == e ? na : ((Gr = Gr || document.createElementNS("http://www.w3.org/2000/svg", "g")).setAttribute("transform", e),
        (e = Gr.transform.baseVal.consolidate()) ? function(e, t, n, r, a, o) {
            var i, l, s;
            (i = Math.sqrt(e * e + t * t)) && (e /= i,
            t /= i);
            (s = e * n + t * r) && (n -= e * s,
            r -= t * s);
            (l = Math.sqrt(n * n + r * r)) && (n /= l,
            r /= l,
            s /= l);
            e * r < t * n && (e = -e,
            t = -t,
            s = -s,
            i = -i);
            return {
                translateX: a,
                translateY: o,
                rotate: Math.atan2(t, e) * ta,
                skewX: Math.atan(s) * ta,
                scaleX: i,
                scaleY: l
            }
        }((e = e.matrix).a, e.b, e.c, e.d, e.e, e.f) : na)
    }
    function aa(e, t) {
        this.message = e,
        this.options = t
    }
    function oa(e, t, n) {
        return t in e && (n = e[t],
        delete e[t]),
        n
    }
    function ia(e) {
        for (var t = 1, n = arguments.length; t < n; t++) {
            var r = arguments[t];
            for (var a in r)
                e[a] = r[a]
        }
        return e
    }
    function la(e, n, t) {
        var r = e.map(function(e, t) {
            return t
        });
        if (n) {
            var a = e.map("function" == typeof n ? function(e, t) {
                return [n(e), t]
            }
            : function(e, t) {
                return [e[n], t]
            }
            );
            r.sort(function(e, t) {
                var n = a[e][0]
                  , r = a[t][0];
                return n < r ? -1 : r < n ? 1 : a[e][1] - a[t][1]
            }),
            t = !t && void 0 !== t;
            for (var o = 0, i = r.length, l = []; o < i; o++)
                l[r[o]] = t ? o : i - o - 1;
            r = l
        }
        return r
    }
    function sa(e, t) {
        for (var n in t)
            "object" == m(t[n]) && (t[n] = ea(e, t[n]));
        return t
    }
    var ca = ".sanddance"
      , ua = {
        grid: function(e, t) {
            var n = t.data
              , r = t.width
              , a = t.height
              , o = r * a / n.length
              , i = Math.sqrt(o)
              , l = Math.ceil(r / i)
              , s = Math.ceil(n.length / l)
              , c = i * s
              , u = t.filter
              , f = la(n = u ? n.filter(function(e, t) {
                return u(e, t)
            }) : n, t.sort, t.ascending);
            return e.transform = function(e, t) {
                var n = (t = f[t]) % l
                  , r = Math.floor(t / l);
                return "translate(" + (this.dataset._sd_x = n * i) + "," + (this.dataset._sd_y = c - (r + 1) * i) + ")"
            }
            ,
            {
                attrs: sa(n, e),
                options: t
            }
        },
        hexpack: function(e, t) {
            var n, r = t.data, a = t.filter, o = la(r = a ? r.filter(function(e, t) {
                return a(e, t)
            }) : r, t.sort, t.sort_ascending), i = r.length, l = [[0, 0]], s = 1, c = 0;
            for (; c < i; ) {
                for (n = 0; 1 - s <= n; n--)
                    l.push([s, n]);
                for (n = s; 1 <= n; n--)
                    l.push([n, -s]);
                for (n = 0; 1 - s <= n; n--)
                    l.push([n, -s - n]);
                for (n = 0; n <= s - 1; n++)
                    l.push([-s, n]);
                for (n = -s; n <= -1; n++)
                    l.push([n, s]);
                for (n = 0; n <= s - 1; n++)
                    l.push([n, s - n]);
                c += 6 * s,
                s++
            }
            var u = t.width
              , f = t.height
              , d = 2 * s - 1
              , p = u / d
              , h = f / d
              , m = p * Math.cos(60 * Math.PI / 180)
              , v = h * Math.sin(60 * Math.PI / 180);
            return l = l.slice(0, i).map(function(e) {
                return [e[0] * p + e[1] * m + u / 2, e[1] * v + f / 2]
            }),
            e.transform = function(e, t) {
                t = o[t];
                var n = l[t];
                return "translate(" + n[0] + "," + n[1] + ")"
            }
            ,
            {
                attrs: sa(r, e),
                options: t
            }
        },
        spiral: function(e, t) {
            var n = t.data
              , r = t.filter
              , a = la(n = r ? n.filter(function(e, t) {
                return r(e, t)
            }) : n, t.sort, t.sort_ascending)
              , o = oa(t, "spiral_size")
              , i = oa(t, "spiral_angle") * Math.PI / 180
              , l = n.map(function(e, t) {
                return [t * o * Math.cos(t * i), t * o * Math.sin(t * i)]
            });
            return e.transform = function(e, t) {
                return t = a[t],
                "translate(" + l[t][0] + "," + l[t][1] + ")"
            }
            ,
            {
                attrs: sa(n, e),
                options: t
            }
        }
    };
    function fa(s, c) {
        c = c || {};
        var e, u = d3.dispatch("init", "start", "end");
        c.layout && (e = ua[c.layout](s, c),
        s = e.attrs,
        c = e.options);
        function n(e) {
            u.call("init", e);
            var t = m ? e.filter(m) : e
              , n = t.transition().ease(h);
            if (v || g) {
                var a = "function" == typeof v ? v : function() {
                    return v
                }
                  , o = "function" == typeof g ? g : function() {
                    return g
                }
                ;
                n.attr("transform", function(e, t) {
                    var n = a(e, t)
                      , r = o(e, t);
                    return "translate(" + (this.dataset._sd_x = n) + "," + (this.dataset._sd_y = r) + ")"
                })
            }
            for (var r in s)
                n = n.attr(r, s[r]);
            "duration"in c ? n = n.duration(f) : d && (n = n.duration(function(e) {
                var t = ra(this.getAttribute("transform"));
                return function(e, t, n, r) {
                    var a = n - e
                      , o = r - t;
                    return Math.sqrt(a * a + o * o)
                }(t.translateX, t.translateY, this.dataset._sd_x, this.dataset._sd_y) / ("function" == typeof d ? d(e) : d) * 1e3
            })),
            p && (n = n.delay(function(e) {
                return "function" == typeof p ? p(e) : p
            }));
            var i = t.size()
              , l = 0;
            n.on("start.count", function() {
                0 === l && u.call("start", e),
                l++
            }),
            n.on("end interrupt", function() {
                if (!(0 < --i)) {
                    if (0 === i)
                        return u.call("end", e);
                    throw new aa("sanddance: Invalid count: " + i,c)
                }
            })
        }
        var f = c.duration
          , d = c.speed
          , p = c.delay || 0
          , h = c.easing || d3.easeLinear
          , m = c.filter
          , v = c.x
          , g = c.y;
        return n.on = function(e, t) {
            return u.on(e + ca, t),
            n
        }
        ,
        n.update = function(e, t) {
            return fa(ia({}, s, e), ia({}, c, t))
        }
        ,
        n
    }
    fa.chain = function() {
        for (var e = 0, t = arguments.length - 1; e < t; e++)
            !function(e, t) {
                e.on("end" + ca, function() {
                    this.call(t)
                })
            }(arguments[e], arguments[e + 1]);
        return arguments[0]
    }
    ;
    var da = ["href", "protocol", "origin", "userinfo", "username", "password", "hostname", "port", "relative", "pathname", "directory", "file", "search", "hash"]
      , pa = ["searchKey", "searchList"]
      , ha = /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/
      , ma = /(?:^|&)([^&=]*)=?([^&]*)/g
      , va = function(e) {
        return decodeURIComponent(e.replace(/\+/g, "%20"))
    }
      , ga = encodeURIComponent;
    function ba(e) {
        for (var t = {
            toString: ya,
            join: _a,
            update: ja
        }, n = ha.exec(e || ""), r = 14; r--; )
            t[da[r]] = n[r] || "";
        var a = t[pa[0]] = {}
          , o = t[pa[1]] = {};
        return t[da[12]].replace(ma, function(e, t, n) {
            t && (t = va(t),
            n = va(n),
            a[t] = n,
            o[t] = o[t] || [],
            o[t].push(n))
        }),
        t
    }
    function ya(e) {
        var t, n, r, a, o = (e = e || this)[da[1]] || "http", i = e[da[4]], l = e[da[5]], s = e[da[6]], c = e[da[7]], u = e[da[9]], f = e[da[12]], d = e[da[13]], p = e[pa[0]], h = e[pa[1]], m = s ? [o, "://"] : [], v = [];
        if (i && (m.push(i),
        l && m.push(":", l),
        m.push("@")),
        m.push(s),
        c && m.push(":", c),
        m.push(u || (s ? "/" : "")),
        f)
            m.push("?", f);
        else {
            if (h)
                for (t in h) {
                    for (r = 0,
                    a = (n = h[t]).length; r < a; r++)
                        v.push(ga(t) + "=" + ga(n[r]));
                    a || v.push(t)
                }
            else if (p)
                for (t in p)
                    v.push(ga(t) + "=" + ga(p[t]));
            v.length && m.push("?", v.join("&"))
        }
        return d && m.push("#", d),
        m.join("")
    }
    function _a(e, t) {
        t = t || {};
        var n, r, a = this, o = a[da[9]].split("/"), i = o.length - 1, l = ba(e), s = l.pathname.split("/"), c = s.length;
        for (void 0 === t.query && (t.query = !0),
        void 0 === t.hash && (t.hash = !0),
        n = 0; n < 14; n++)
            9 != n && (12 == n && !t.query || 13 == n && !t.hash || !l[da[n]] || (a[da[n]] = l[da[n]]));
        for (t.query && l[da[12]] && (a[pa[0]] = l[pa[0]],
        a[pa[1]] = l[pa[1]]),
        n = 0; n < c; n++)
            "." == (r = s[n]) ? o[i] = "" : ".." == r ? o[--i] = "" : "" === r ? 1 < c && (n || (o[0] = r,
            i = 1),
            n == c - 1 && (o[i] = r)) : (o[i] = r,
            n < c - 1 && i++);
        var u = a[da[9]] = o.slice(0, i + 1).join("/")
          , f = u.split(/\//)
          , d = [u];
        return a[da[12]] && d.push("?", a[da[12]]),
        a[da[13]] && d.push("#", a[da[13]]),
        a[da[8]] = d.join(""),
        a[da[10]] = f.slice(0, f.length - 1).join("/") + "/",
        a[da[11]] = f[f.length - 1],
        a
    }
    function ja(e, t) {
        var n, r, a, o, i, l, s, c = this[pa[0]], u = this[pa[1]], f = [], d = {};
        if (t)
            if ((t = "" + t).match(/[&=]/))
                d = ba("?" + t).searchKey;
            else
                for (n in e)
                    d[n] = t;
        for (n in e) {
            if (null === (r = e[n]))
                u[n] = [];
            else if (Array.isArray(r) || (r = [r]),
            d[n]) {
                n in u || (u[n] = []);
                for (i = {},
                a = 0,
                o = r.length; a < o; a++)
                    i[r[a].toString()] = 1;
                if ((t = "" + d[n]).match(/add/i))
                    u[n] = u[n].concat(r);
                else if (t.match(/del/i)) {
                    for (s = [],
                    a = 0,
                    o = (l = u[n]).length; a < o; a++)
                        i[l[a]] || s.push(l[a]);
                    u[n] = s
                } else if (t.match(/toggle/i)) {
                    for (s = [],
                    a = 0,
                    o = (l = u[n]).length; a < o; a++)
                        i[l[a]] ? i[l[a]] = 2 : s.push(l[a]);
                    for (r in i)
                        1 == i[r] && s.push(r);
                    u[n] = s
                }
            } else
                u[n] = r;
            0 === u[n].length ? (delete c[n],
            delete u[n]) : c[n] = u[n][u[n].length - 1]
        }
        for (n in u)
            for (a = 0,
            o = (r = u[n]).length; a < o; a++)
                f.push(ga(n) + "=" + ga(r[a]));
        return this.search = f.join("&"),
        this
    }
    function wa(e, t) {
        return e.filter(t).add(e.find(t))
    }
    function xa(e, t, n) {
        var r = e.data(t);
        return void 0 === r || !1 === r || null === r ? n : "string" != typeof r || !r.match(/^(false|off|n|no)$/i)
    }
    var $a = {
        attr: "href",
        event: "click change submit",
        selector: ".urlfilter",
        src: "src"
    };
    var ka = {
        parse: ba,
        unparse: ya,
        join: _a,
        update: ja
    };
    function Oa(o, i, l, s) {
        return i = i || $("<div>"),
        l = l || [],
        s = s || [],
        "limit"in o || (o.limit = 10),
        o.limit--,
        $.ajax(o).done(function(e, t, n) {
            if (l.push(o),
            s.push(e),
            i.trigger({
                type: "load",
                request: o,
                response: e,
                xhr: n
            }),
            o.chain && 0 < o.limit) {
                try {
                    var r = o.chain(e, o, n)
                } catch (e) {
                    i.trigger({
                        type: "error",
                        request: o,
                        xhr: n,
                        exception: e
                    }),
                    console.warn("$.ajaxchain: chain() exception", e)
                }
                if ($.isPlainObject(r) && !$.isEmptyObject(r))
                    var a = Oa($.extend(!0, {}, o, r), i, l, s)
            }
            a || i.trigger({
                type: "done",
                request: l,
                response: s
            })
        }).fail(function(e, t, n) {
            i.trigger({
                type: "error",
                request: o,
                xhr: e
            }),
            i.trigger({
                type: "done",
                request: l,
                response: s
            }),
            console.warn("$.ajaxchain: ajax error", n)
        }),
        i
    }
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        urlfilter: function(e) {
            if (0 != this.length) {
                var t = this[0].ownerDocument
                  , d = $.extend({}, $a, e || {}, this.dataset)
                  , p = d.remove || xa(this, "remove")
                  , n = d.event.split(/\s+/).map(function(e) {
                    return e + ".urlfilter"
                }).join(" ")
                  , h = d.location || (t.defaultView || t.parentWindow).location
                  , m = d.history || (t.defaultView || t.parentWindow).history;
                return this.on(n, d.selector, function(e) {
                    var a, t = $(this), o = t.data("mode") || d.mode, n = t.data("target") || d.target, r = t.data("src") || d.src, i = xa(t, "remove", p);
                    if ("change" == e.type || $(e.target).is(":input:not(:button)")) {
                        var l = encodeURIComponent(t.attr("id") || t.attr("name"))
                          , s = encodeURIComponent(t.val());
                        a = "?" + l + "=" + s
                    } else if ("submit" == e.type || $(e.target).is("form"))
                        e.preventDefault(),
                        a = "?" + t.serialize();
                    else {
                        if ("click" != e.type)
                            return;
                        $(e.target).is("a") && e.preventDefault(),
                        a = t.attr(d.attr)
                    }
                    var c = ba(a)
                      , u = c.searchList;
                    function f(e) {
                        var t = ba(e).join(a, {
                            query: !1,
                            hash: !1
                        }).update(u, o);
                        if (i) {
                            var n = {};
                            for (var r in t.searchKey)
                                "" === t.searchKey[r] && (n[r] = null);
                            t.update(n)
                        }
                        return t.toString()
                    }
                    n ? "#" == n ? h.hash = f(h.hash.replace(/^#/, "")) : n.match(/^pushstate$/i) ? m.pushState({}, "", f(h.href)) : $(n).each(function() {
                        var e = $(this)
                          , t = f(e.attr(r));
                        e.attr(r, t).load(t, function() {
                            e.trigger({
                                type: "load",
                                url: t
                            })
                        })
                    }) : h.href = f(h.href),
                    t.trigger({
                        type: "urlfilter",
                        url: c
                    })
                })
            }
        }
    }),
    Oa.list = function(r) {
        return function(e, t) {
            var n = r.indexOf(t.url) + 1;
            if (n < r.length)
                return {
                    url: r[n]
                }
        }
    }
    ,
    Oa.cursor = "undefined" == typeof _ ? function() {
        throw new Error("ajaxchain.cursor requires lodash")
    }
    : function(n, r) {
        return function(e) {
            var t = _.get(e, r);
            if (t)
                return _.set({}, n, t)
        }
    }
    ,
    "undefined" != typeof jQuery && jQuery.extend(jQuery, {
        ajaxchain: Oa
    });
    var Ea = "<% var urlfilterClass = key ? 'urlfilter' : '',\nmultiple = multiple ? 'multiple' : '',\nkey = key ? key : '' %> <select class=\"selectpicker border <%- urlfilterClass %>\" id=\"<%- key %>\" <%-multiple%>></select>"
      , Aa = '<div class="alert alert-warning" role="alert"><p class="text-center"> <%- message %> </p></div>'
      , Sa = Object.freeze({
        template_dropdown: Ea,
        template_dropdown_options: '<% _.each(data, function(item) { %> <option value="<%- item %>"><%- item %></option> <% }) %>',
        template_dropdown_object: '<% _.each(data, function(item) { %> <option value="<%- item[value_key] %>" label="<%- item[label_key] %>"><%- item[label_key] %></option> <% }) %>',
        template_error: Aa
    })
      , Ca = function(e) {
        return function(e) {
            return !!e && "object" === (void 0 === e ? "undefined" : m(e))
        }(e) && !function(e) {
            var t = Object.prototype.toString.call(e);
            return "[object RegExp]" === t || "[object Date]" === t || function(e) {
                return e.$$typeof === Ia
            }(e)
        }(e)
    };
    var Ia = "function" == typeof Symbol && Symbol.for ? Symbol.for("react.element") : 60103;
    function za(e, t) {
        return !1 !== t.clone && t.isMergeableObject(e) ? Ma(function(e) {
            return Array.isArray(e) ? [] : {}
        }(e), e, t) : e
    }
    function qa(e, t, n) {
        return e.concat(t).map(function(e) {
            return za(e, n)
        })
    }
    function Ma(e, t, n) {
        (n = n || {}).arrayMerge = n.arrayMerge || qa,
        n.isMergeableObject = n.isMergeableObject || Ca;
        var r = Array.isArray(t);
        return r === Array.isArray(e) ? r ? n.arrayMerge(e, t, n) : function(t, n, r) {
            var a = {};
            return r.isMergeableObject(t) && Object.keys(t).forEach(function(e) {
                a[e] = za(t[e], r)
            }),
            Object.keys(n).forEach(function(e) {
                r.isMergeableObject(n[e]) && t[e] ? a[e] = Ma(t[e], n[e], r) : a[e] = za(n[e], r)
            }),
            a
        }(e, t, n) : za(t, n)
    }
    Ma.all = function(e, n) {
        if (!Array.isArray(e))
            throw new Error("first argument should be an array");
        return e.reduce(function(e, t) {
            return Ma(e, t, n)
        }, {})
    }
    ;
    var Ta, Na = Ma, La = {
        target: "",
        multiple: !1,
        value_key: "value",
        label_key: "label"
    };
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        dropdown: function(e) {
            var r = $(this)
              , n = Na(La, e);
            function t(e) {
                n.data = e,
                n.key && r.urlfilter({
                    selector: "select.urlfilter",
                    target: n.target,
                    event: "change",
                    remove: !0
                });
                var t = "object" == m(e[0]) ? "template_dropdown_object" : "template_dropdown_options";
                r.find(".selectpicker").html(_.template(Sa[t])(n)).selectpicker(n.options)
            }
            return r.html(_.template(Ea)(n)),
            n.data ? (t(n.data),
            n.value && r.find(".selectpicker").val(n.value).selectpicker("refresh"),
            r.trigger({
                type: "load"
            })) : n.url && (t(["Loading..."]),
            $.ajax(n.url).fail(function(e, t, n) {
                r.html(_.template(Aa)({
                    message: n
                }))
            }).done(function(e) {
                t(e),
                r.find(".selectpicker").selectpicker("refresh"),
                r.trigger({
                    type: "load"
                })
            })),
            this
        }
    });
    try {
        new Event("click"),
        Ta = function(e, t) {
            return new Event(e,t)
        }
    } catch (e) {
        Ta = function(e, t) {
            var n = document.createEvent("event");
            return n.initEvent(e, t.bubbles, t.cancelable),
            n
        }
    }
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        dispatch: function(e, t) {
            return this.each(function() {
                this.dispatchEvent(Ta(e, $.extend({
                    bubbles: !0,
                    cancelable: !0
                }, t)))
            })
        }
    });
    var Pa = Object.freeze({
        template_: '<div class="position-relative"><div class="formhandler"><div class="note"></div><div class="formhandler-table-header d-flex justify-content-between mb-2"><div class="d-flex flex-wrap"><div class="edit"></div><div class="add"></div><div class="count"></div><div class="page"></div><div class="size"></div></div><div class="d-flex"><div class="filters"></div><div class="export"></div></div></div><div class="<%- (options.table == \'grid\') ? \'table_grid\' : \'table\' %>"></div></div><div class="loader pos-cc d-none"><div class="fa fa-spinner fa-spin fa-3x fa-fw"></div><span class="sr-only">Loading...</span></div></div><div class="modal formhandler-table-modal" id="fh-modal-<%- idcount %>" tabindex="-1" role="dialog" aria-labelledby="fh-label-<%- idcount %>" aria-hidden="true"><div class="modal-dialog modal-sm" role="document"><div class="modal-content"><form class="formhandler-table-modal-form modal-body"><label id="fh-label-<%- idcount %>" for="formhandler-table-modal-value">Value</label><p><input class="form-control" name="filter_input"></p><div><button type="button" class="btn btn-sm btn-secondary mr-1" data-dismiss="modal">Cancel</button><button type="submit" class="btn btn-sm btn-primary mr-1">Apply filter</button><a class="btn btn-sm btn-danger remove-action urlfilter" data-dismiss="modal" data-target="#" href="#">Remove filter</a></div></form></div></div></div>',
        template_table: '<%\n  var filtered_cols = args[\'_c\'] && args[\'_c\'].length != options.columns.length ?\n                      options.columns.filter(function(col) { return args[\'_c\'].indexOf(\'-\' + col.name) < 0 }) :\n                      options.columns\n  var cols = options.columns.length ? filtered_cols : meta.columns;\n  cols = cols.filter(function(col) { return col.hide !== true})\n  var form_id = idcount\n%> <table class="table table-sm table-striped"><thead> <% _.each(cols, function(colinfo) {\n        col_defaults(colinfo, data)\n        var menu_item = false\n        var col_id = idcount++\n        var qsort = parse(\'?\')\n        var isSorted = _.includes(args[\'_sort\'], colinfo.name) ? {op: \'\', cls: \'table-primary\'} : _.includes(args[\'_sort\'], \'-\' + colinfo.name) ? {op: \'-\', cls: \'table-danger\'} : {}\n      %> <th class="<%- isSorted.cls %>" data-col="<%- colinfo.name %>"><div class="dropdown"><a href="#" class="dropdown-toggle text-nowrap" id="fh-dd-<%- col_id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <%- colinfo.title || colinfo.name %> </a><div class="dropdown-menu" aria-labelledby="fh-dd-<%- col_id %>"> <% _.each(colinfo.sort, function(title, op) { menu_item = true\n              qsort = qsort.update({_sort: args[\'_sort\'] || []})\n              if (!_.isEmpty(isSorted))\n                qsort = qsort.update({_sort: [colinfo.name, \'-\' + colinfo.name]}, \'del\')\n              var active = _.includes(args[\'_sort\'], op + colinfo.name) %> <a class="dropdown-item urlfilter <%- active ? \'active\': \'\' %>" href="<%- qsort.update({_sort: [op + colinfo.name]}, active ? \'del\': \'add\').toString() %>"> <%- title %> </a> <% }) %> <% if (menu_item) { %> <div class="dropdown-divider"></div> <% menu_item = false } %> <% _.each(colinfo.filters, function(title, op) { menu_item = true %> <a class="dropdown-item <%= colinfo.name + op in args ? \'active\' : \'\' %>" href="#" data-op="<%- op %>" data-toggle="modal" data-target="#fh-modal-<%- form_id %>"> <%- title %> </a> <% }) %> <% if (menu_item) {\n              menu_item = false %> <div class="dropdown-divider"></div> <% } %> <% if (colinfo.hideable) { %> <a class="dropdown-item urlfilter" href="?_c=-<%- encodeURIComponent(colinfo.name) %>" data-mode="add">Hide</a> <% } %> </div></div></th> <% }) %> </thead><tbody> <% if (isAdd) { %> <tr class="new-row"> <% _.each(cols, function(colinfo) {\n          if (!colinfo.template) { %> <td data-key="<%- colinfo.name %>"> <% var isEditable = colinfo.editable === undefined ? true : colinfo.editable %> <%= _.template(templates[\'template_editable\'])({isEditable: isEditable, val: undefined}) %> </td> <% } else { %> <td></td> <% } %> <% }) %> </tr> <% } %> <% if (options.rowTemplate) { %> <% _.each(data, function(row, rowIndex) { %> <%= typeof options.rowTemplate == \'function\' ? options.rowTemplate({row: row, data: data, index: rowIndex}) : _.template(options.rowTemplate)({row: row, data: data, index: rowIndex}) %> <% }) %> <% } else {%> <% _.each(data, function(row, rowIndex) { %> <tr data-val="<%- JSON.stringify(row) %>" data-row="<%- rowIndex %>"> <% _.each(cols, function(colinfo) { %> <% var fmt = typeof(colinfo.format),\n            val = row[colinfo.name],\n            isEditable = colinfo.editable === undefined ? true : colinfo.editable,\n            disp = fmt == "function" ?\n              colinfo.format({name: colinfo.name, value: val, index: rowIndex, row: row, data:data }) :\n            fmt === "string" && colinfo.type === "number" ?\n              numeral(val).format(colinfo.format) :\n            fmt === "string" && colinfo.type === "date" ?\n              moment.utc(val).format(colinfo.format):\n              val,\n            col_link\n          %> <% if (!isEdit && colinfo.template) { %> <%= typeof colinfo.template == \'function\' ?\n              colinfo.template({name: colinfo.name, value: val, format: disp, link: col_link, index: rowIndex, row: row, data: data}) :\n              _.template(colinfo.template)(({name: colinfo.name, value: val, format: disp, link: col_link, index: rowIndex, row: row, data: data})) %> <% } else if (!isEdit && \'link\' in colinfo) { %> <% col_link = typeof colinfo.link == \'function\' ?\n              colinfo.link({name: colinfo.name, value: val, format: disp, index: rowIndex, row: row, data: data}) :\n              (typeof colinfo.link == \'string\' ?\n                _.template(colinfo.link)({name: colinfo.name, value: val, format: disp, index: rowIndex, row: row, data: data})\n                : colinfo.link)\n                %> <% if (col_link === false) { %> <td><%= disp %></td> <% } else if (col_link && col_link[0] == \'?\') { %> <td><a class="urlfilter" href="<%- col_link %>"><%= disp %></a></td> <% } else { %> <td><a href="<%- col_link %>" target="_blank"><%= disp %></a></td> <% } %> <% } else if (isEdit && isEditable) { %> <td data-key="<%- colinfo.name %>"> <%= _.template(templates[\'template_editable\'])({isEditable: isEditable, val: val}) %> </td> <% } else { %> <td><a class="urlfilter" href="?<%- encodeURIComponent(colinfo.name) %>=<%- encodeURIComponent(val) %>&_offset="> <%= disp %> </a></td> <% } %> <% }) %> </tr> <% }) %> <% } %> </tbody></table>',
        template_editable: '<% if (isEditable.input == \'select\') { %> <select <% for (key in isEditable.attrs) { %> <%= key + \'="\' + isEditable.attrs[key] + \'"\' %> <% } %> class="form-control form-control-sm"><option value="" disabled selected>-- select --</option> <% _.each(isEditable.options, function(item) { %> <option <%- val !== undefined && val === item ? \'selected\': null %> value="<%- item %>"> <%- item %> </option> <% }) %> </select> <% } else if (isEditable.input == \'radio\') { %> <% _.each(isEditable.options, function(item) { %> <input type="radio" <%- val !== undefined && val === item ? \'checked\': null %> value="<%- item %>" <% for (key in isEditable.attrs) { %> <%= key + \'="\' + isEditable.attrs[key] + \'"\' %> <% } %> class="form-control form-control-sm"> <%- item %> <br> <% }) %> <% } else { %> <input type="<%- isEditable.input || \'text\' %>" value="<%- val %>" <% for (key in isEditable.attrs) { %> <%= key + \'="\' + isEditable.attrs[key] + \'"\' %> <% } %> class="form-control form-control-sm"> <% } %> <% if (isEditable.validationMessage) { %> <div class="invalid-feedback"> <%- isEditable.validationMessage %> </div> <% } %>',
        template_page: '<% var page = 1 + Math.floor(meta.offset / meta.limit),\n      last_page = \'count\' in meta ? Math.floor((meta.count + meta.limit - 1) / meta.limit) : meta.rows < meta.limit ? page : null,\n      lo = Math.max(page - 2, 1),\n      hi = last_page !== null ? Math.min(last_page, page + 2) : page + 2 %> <ul class="pagination pagination-sm mr-2"><li class="page-item <%- page <= 1 ? \'disabled\' : \'\' %>"><a class="page-link" href="?_offset=<%- meta.offset - meta.limit %>">Previous</a></li> <% if (lo > 1) { %> <li class="page-item"><a class="page-link" href="?_offset=">1</a></li> <% if (lo > 2) { %> <li class="page-item disabled"><a class="page-link" href="#">...</a></li> <% } %> <% } %> <% _.each(_.range(lo, hi + 1), function(pg) { %> <li class="page-item <%- pg == page ? \'active\' : \'\' %>"><a class="page-link" href="?_offset=<%- meta.limit * (pg - 1) || \'\' %>"> <%- pg %> </a></li> <% }) %> <% if (\'count\' in meta) { %> <% if (hi + 1 < last_page) { %> <li class="page-item disabled"><a class="page-link" href="#">...</a></li> <% } %> <% if (hi < last_page || lo > hi) { %> <li class="page-item"><a class="page-link" href="?_offset=<%- meta.limit * (last_page - 1) %>"> <%- last_page %> </a></li> <% } %> <% } %> <li class="page-item <%- (last_page === null) || (page < last_page) ? \'\' : \'disabled\' %>"><a class="page-link" href="?_offset=<%- meta.offset + meta.limit %>">Next</a></li></ul>',
        template_size: '<% if (meta.limit) { %> <div class="btn-group btn-group-sm mr-2" role="group"><button id="formhandler-size-<%- idcount++ %>" type="button" class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <%- meta.limit %> rows</button><div class="dropdown-menu" aria-labelledby="formhandler-size-<%- idcount %>"> <% _.each(options.sizeValues, function(size) { %> <a class="dropdown-item <%- meta.limit == size ? \'active\' : \'\' %> urlfilter" href="?_limit=<%- size %>"> <%- size %> </a> <% }) %> </div></div> <% } %>',
        template_count: "<% if ('count' in meta) { %> <span class=\"btn btn-sm btn-light mr-2\"> <%- meta.count %> rows</span> <% } %>",
        template_edit: '<button type="submit" class="btn btn-success mr-2 btn-sm edit-btn">Edit</button>',
        template_add: '<button type="button" class="btn btn-success mr-2 btn-sm add-btn">Add</button>',
        template_export: '<div class="btn-group btn-group-sm" role="group"><button id="formhandler-export-<%- idcount++ %>" type="button" class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Export as</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="formhandler-export-<%- idcount %>"> <% _.each(options.exportFormats, function(label, key) { %> <a class="dropdown-item" href="<%- parse(options.src).update(args).update({_format: key}) %>"> <%- label %> </a> <% }) %> </div></div>',
        template_filters: '<div class="p-1"><%\n  var qparts = parse(\'?\')\n  _.each(args[\'_c\'], function(col_name) {\n    qparts.update({_c: col_name}, \'add\')\n    var hide_col = col_name[0] == \'-\'\n    var display_name = hide_col ? col_name.slice(1) : col_name %> <a href="?_c=<%- encodeURIComponent(col_name) %>" data-mode="del" class="badge badge-pill <%- hide_col ? \'badge-dark\' : \'badge-danger\' %> urlfilter" title="<%- hide_col ? \'Show\' : \'Hide\' %> column <%- display_name %>"> <%- display_name %> </a> <% })\n  _.each(args, function(list_values, key) {\n    if (key.charAt(0) !== \'_\' && key !== \'c\') {\n      _.each(args[key], function(col_name) {\n        var update = {}\n        update[key] = col_name\n        qparts.update(update, \'add\') %> <a href="?<%- encodeURIComponent(key) %>=<%- encodeURIComponent(col_name) %>" data-mode="del" class="badge badge-pill badge-dark urlfilter" title="Clear <%- key %> filter"> <%- key %> = <%- col_name %> </a> <% })\n    }\n  })\n  qparts = qparts.toString()\n  if (qparts && qparts != \'?\') { %> <a href="?<%- qparts.slice(1) %>" class="badge badge-pill badge-danger urlfilter" data-mode="del" title="Clear all filters"></a> <% } %> </div>',
        template_error: '<div class="alert alert-warning alert-dismissible" role="alert"> <%- message %> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true"></span></button></div>',
        template_table_grid: '<%\n  var filtered_cols = args[\'_c\'] && args[\'_c\'].length != options.columns.length ?\n                      options.columns.filter(function(col) { return args[\'_c\'].indexOf(\'-\' + col.name) < 0 }) :\n                      options.columns\n  var cols = options.columns.length ? filtered_cols : meta.columns\n  var form_id = idcount, img\n  if (options.rowTemplate) {\n    _.each(data, function(row, rowIndex) { %> <%= typeof options.rowTemplate == \'function\' ? options.rowTemplate({row: row, index: rowIndex, data: data}) : _.template(options.rowTemplate)({row: row, data: data, index: rowIndex}) %> <% })\n} else { %> <div class="formhandler-grid row"> <% _.each(data, function(row, rowIndex) { %> <div class="col-sm-3 <%= options.classes || \'formhandler-grid-cell d-inline-block p-3 box-shadow\' %>"><div class="thumbnail"> <% img = options.icon ? ((typeof(options.icon) == \'function\' ? options.icon({row: row, data: data, index: rowIndex}) : options.icon)) : \'fa fa-home\' %> <% if (img.indexOf(\'fa \') >= 0) { %> <i class="<%= img %>"></i> <% } else { %> <img class="img img-responsive" src="<%= img %>"> <% } %> <div class="caption"> <% _.each(cols, function(colinfo) {\n              var fmt = typeof(colinfo.format),\n                  val = row[colinfo.name],\n                  disp = (fmt == "function" ? colinfo.format({index: rowIndex, name: colinfo.name, value: val, row: row, data:data }) :\n                          fmt === "string" && colinfo.type === "number" ? numeral(val).format(colinfo.format) :\n                          fmt === "string" && colinfo.type === "date" ? moment.utc(val).format(colinfo.format) :\n                          val) %> <div><strong><%= colinfo.name %></strong>: <% if (\'link\' in colinfo) { %> <% var col_link = typeof colinfo.link == \'function\' ?\n                      colinfo.link({row: row, value: val, index: rowIndex, name: colinfo.name, data: data, format: disp}) :\n                      _.template(colinfo.link)({row: row, value: val, index: rowIndex, name: colinfo.name, data: data, format: disp}) %> <% if (col_link === false) { %> <%= disp %> <% } else if (col_link && col_link[0] == \'?\') { %> <a class="urlfilter" href="<%- col_link %>"><%= disp %></a> <% } else { %> <a href="<%- col_link %>" target="_blank"><%= disp %></a> <% } %> <% } else { %> <a class="urlfilter" href="?<%- encodeURIComponent(colinfo.name) %>=<%- encodeURIComponent(val) %>&_offset="> <%= disp %> </a> <% } %> </div> <% }) %> </div></div></div> <% }) %> </div> <% } %>'
    })
      , Da = ["", "table", "edit", "add", "page", "size", "count", "export", "filters", "error", "table_grid"]
      , Qa = {
        table: !0,
        edit: !1,
        add: !1,
        page: !0,
        pageSize: 100,
        size: !0,
        sizeValues: [10, 20, 50, 100, 500, 1e3],
        count: !0,
        export: !0,
        exportFormats: {
            xlsx: "Excel",
            csv: "CSV",
            json: "JSON",
            html: "HTML"
        },
        filters: !0,
        onhashchange: !0
    }
      , Ra = ["filters", "ignored", "excluded", "sort", "offset", "limit", "count"]
      , Ua = {
        text: {
            "": "Equals...",
            "!": "Does not equal...",
            "~": "Contains...",
            "!~": "Does not contain..."
        },
        number: {
            "": "Equals...",
            "!": "Does not equal...",
            "<": "Less than...",
            ">": "Greater than..."
        },
        date: {
            "": "Equals...",
            "!": "Does not equal...",
            "<": "Before...",
            ">": "After..."
        }
    };
    function Fa(e) {
        "sort"in e && !0 !== e.sort ? "object" != m(e.sort) && (e.sort = {}) : e.sort = {
            "": "Sort ascending",
            "-": "Sort descending"
        },
        e.type = e.type || "text",
        "filters"in e && !0 !== e.filters || (e.filters = Ua[e.type]),
        "hideable"in e || (e.hideable = !0),
        "hide"in e || (e.hide = !1)
    }
    function Ba(e, t, n, r, a) {
        if (!e || n[e]) {
            var o;
            if (e) {
                "grid" == n[e] && (e = "table_grid");
                var i = n[e + "Target"] || "." + e;
                0 == (o = $(i, r)).length && (o = $(i))
            } else
                o = r;
            o.html(a[e](t))
        }
    }
    function Va(e, t, n) {
        var r = $(".note", e);
        r.length || (r = $('<div class="note"></div>').appendTo(e)),
        r.html(t.error({
            message: n
        }))
    }
    function Wa(e, t, n, r, a) {
        var o = r + ": " + a;
        0 == n.readyState && (o += " (cannot connect to server)"),
        Va(e, t, o)
    }
    function Ha(e, t) {
        $("tbody :input", e).on("change", function() {
            $(this).parents("tr").addClass("edited-row")
        }).on("keypress", function(e) {
            13 == e.keyCode && ($(this).blur(),
            t.trigger("click"))
        }).eq(0).focus()
    }
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        formhandler: function(t) {
            return t = t || {},
            this.each(function() {
                var i = $(this);
                i.urlfilter({
                    selector: ".urlfilter, .page-link",
                    target: "#",
                    remove: !0
                });
                var l = $.extend({}, Qa, t, i.data());
                l.columns ? "string" == typeof l.columns && (l.columns = _.map(l.columns.split(/\s*,\s*/), function(e) {
                    return {
                        name: e
                    }
                })) : l.columns = [];
                var s = {};
                function c(e, t, n) {
                    n.rows = e.length,
                    n.columns = e.length ? _.map(e[0], function(e, t) {
                        return {
                            name: t
                        }
                    }) : [];
                    var r = _.find(l.columns, function(e) {
                        return "*" === e.name
                    });
                    if (r) {
                        var a = _.cloneDeep(n.columns);
                        _.map(l.columns, function(t) {
                            _.find(n.columns, function(e) {
                                return e.name === t.name
                            }) || "*" === t.name || a.push(t)
                        }),
                        a = _.map(a, function(t) {
                            var e = _.find(l.columns, function(e) {
                                return e.name === t.name
                            });
                            return e || $.extend({}, r, t)
                        })
                    }
                    l.columns = a || l.columns;
                    var o = {
                        data: e,
                        meta: n,
                        args: t,
                        options: l,
                        idcount: 0,
                        parse: ba,
                        col_defaults: Fa,
                        isEdit: !1,
                        isAdd: !1,
                        templates: Pa,
                        notify: Va.bind(this, i, s),
                        failHandler: Wa.bind(this, i, s)
                    };
                    i.data("formhandler", o),
                    _.each(Da, function(e) {
                        Ba(e, o, l, i, s)
                    }),
                    l.add && function(a, o, i, l) {
                        $(".add button", a).on("click", function() {
                            var e = $(".add button", a)
                              , t = $(".edit button", a);
                            if ("save" == e.html().toLowerCase()) {
                                e.html("Add"),
                                t.prop("disabled", !1);
                                var n = $(".new-row td[data-key]");
                                $(".loader", a).removeClass("d-none");
                                var r = {};
                                if ($.each(n, function(e, t) {
                                    r[t.getAttribute("data-key")] = $(t).children().val()
                                }),
                                !_.some(r))
                                    return $(".loader", a).addClass("d-none"),
                                    o.isAdd = !1,
                                    void Ba("table", o, i, a, l);
                                $.ajax(i.src, {
                                    method: "POST",
                                    dataType: "json",
                                    data: r
                                }).done(function() {
                                    o.data.unshift(r),
                                    o.isAdd = !1,
                                    Ba("table", o, i, a, l),
                                    i.add.done && i.add.done()
                                }).always(function() {
                                    $(".loader", a).addClass("d-none")
                                }).fail(Wa.bind(this, a, l))
                            } else
                                "add" == e.html().toLowerCase() && (e.html("Save"),
                                t.prop("disabled", !0),
                                o.isAdd = !0,
                                Ba("table", o, i, a, l),
                                Ha(a, e))
                        })
                    }(i, o, l, s),
                    l.edit && function(i, l, s, c) {
                        $(".edit button", i).on("click", function() {
                            var e = $(".edit button", i)
                              , t = $(".add button", i);
                            if ("save" == e.html().toLowerCase()) {
                                var n = $(".edited-row");
                                0 < n.length && $(".loader", i).removeClass("d-none");
                                var a = []
                                  , o = !0;
                                if ($.each(n, function(e, t) {
                                    var n = JSON.parse(t.getAttribute("data-val"))
                                      , r = t.getAttribute("data-row");
                                    for (e in n)
                                        $('td[data-key="' + e.toString().replace(/["']/g, "") + '"] :input', t).each(function() {
                                            this.checkValidity() ? ($(this).removeClass("is-invalid"),
                                            n[e] = l.data[r][e] = $(this).val()) : ($(this).addClass("is-invalid"),
                                            o = !1)
                                        });
                                    a.push($.ajax(s.src, {
                                        method: "PUT",
                                        dataType: "json",
                                        data: n
                                    }).fail(Wa.bind(this, i, c)).always(function() {
                                        $(".loader", i).addClass("d-none"),
                                        s.add.editFunction && s.add.editFunction()
                                    }))
                                }),
                                !o)
                                    return;
                                $.when.apply($, a).then(function() {
                                    $(".loader", i).addClass("d-none"),
                                    e.html("Edit"),
                                    t.prop("disabled", !1),
                                    s.edit.done && s.edit.done()
                                }),
                                l.isEdit = !1,
                                Ba("table", l, s, i, c)
                            } else
                                "edit" == e.html().toLowerCase() && (e.html("Save"),
                                t.prop("disabled", !0),
                                l.isEdit = !0,
                                Ba("table", l, s, i, c),
                                Ha(i, e),
                                i.trigger({
                                    type: "editmode"
                                }))
                        })
                    }(i, o, l, s)
                }
                function e() {
                    var e = ba(location.hash.replace(/^#/, "")).searchList;
                    e = h(e, l.name);
                    var o = _.extend({
                        c: l.columns.map(function(e) {
                            return e.name
                        }),
                        _limit: l.pageSize,
                        _format: "json",
                        _meta: "y"
                    }, e);
                    function t(e, t, n) {
                        var r = {};
                        if (_.each(Ra, function(e) {
                            var t = n ? n.getResponseHeader("Fh-Data-" + e) : null;
                            null !== t && (r[e] = JSON.parse(t))
                        }),
                        "function" == typeof l.transform) {
                            var a = l.transform({
                                data: e,
                                meta: r,
                                options: l,
                                args: o
                            }) || {};
                            e = "data"in a ? a.data : e,
                            r = "meta"in a ? a.meta : r
                        }
                        _.isEmpty(r) && l.page && l.size && (r.offset = o._offset ? parseInt(o._offset) : 0,
                        r.limit = parseInt(o._limit),
                        r.count = e.length,
                        e = u(e, o)),
                        c(e, o, r),
                        i.trigger({
                            type: "load",
                            formdata: e,
                            meta: r,
                            args: o,
                            options: l
                        })
                    }
                    $(".loader", i).removeClass("d-none"),
                    l.data && "object" == m(l.data) ? (l.edit = !1,
                    l.add = !1,
                    t(l.data)) : $.ajax(l.src, {
                        dataType: "json",
                        data: o,
                        traditional: !0
                    }).done(t).always(function() {
                        $(".loader", i).addClass("d-none")
                    }).fail(Wa.bind(this, i, s))
                }
                _.each(Da, function(e) {
                    var t = l[e ? e + "Template" : "template"] || Pa["template_" + e] || "NA";
                    s[e] = _.template(t)
                }),
                function(i) {
                    i.on("shown.bs.modal", ".formhandler-table-modal", function(e) {
                        var t = $(e.relatedTarget)
                          , n = i.data("formhandler")
                          , r = t.data("op")
                          , a = t.closest("[data-col]").data("col")
                          , o = "";
                        n.args[a + r] ? (o = n.args[a + r].join(","),
                        $(".remove-action", this).attr("href", "?" + a + r + "=").show()) : $(".remove-action", this).hide(),
                        $("input", this).val(o).attr("name", a + r).focus(),
                        $("label", this).text(t.text())
                    }).on("submit", "form", function(e) {
                        e.preventDefault();
                        var t = ba("?" + $(this).serialize()).searchKey;
                        $(this).closest(".formhandler-table-modal").modal("hide"),
                        window.location.hash = "#" + ba(location.hash.replace(/^#/, "")).update(t)
                    })
                }(i),
                function(r, a, o) {
                    var i = {
                        delete: function(e) {
                            return $.ajax(a.src, {
                                method: "DELETE",
                                dataType: "json",
                                data: e.row
                            }).done(function() {
                                $('tr[data-row="' + e.index + '"]', r).remove()
                            })
                        }
                    };
                    r.on("click", "[data-action]", function() {
                        var e = {
                            row: $(this).closest("[data-val]").data("val"),
                            index: $(this).closest("[data-row]").data("row"),
                            notify: Va.bind(this, r, o)
                        }
                          , t = $(this).data("action")
                          , n = (a.actions && 0 < a.actions.filter(function(e) {
                            return t in e
                        }).length ? a.actions.filter(function(e) {
                            return t in e
                        })[0][t] : i[t])(e);
                        n && n.always && ($(".loader", r).removeClass("d-none"),
                        n.always(function() {
                            $(".loader", r).addClass("d-none")
                        }).fail(Wa.bind(this, r, o)))
                    })
                }(i, l, s),
                l.onhashchange && $(window).on("hashchange", e),
                e()
            }),
            this
        }
    });
    var Ja = {
        selector: '[data-toggle="highlight"]',
        target: ".highlight-target",
        mode: "hover",
        classes: "active"
    };
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        highlight: function(e) {
            return this.each(function() {
                var r = $.extend({}, Ja, e, this.dataset)
                  , a = this;
                wa($(this), r.selector).each(function() {
                    var t = $.extend({}, r, this.dataset)
                      , n = $(this).off(".g1.highlight")
                      , e = "click" == t.mode ? "click.g1.highlight" : "mouseenter.g1.highlight mouseleave.g1.highlight";
                    n.on(e, function() {
                        var e = $(t.target, a).toggleClass(t.classes);
                        n.trigger({
                            type: "highlight",
                            target: e
                        })
                    })
                })
            }),
            this
        }
    }),
    "undefined" != typeof L && (L.TopoJSON = L.GeoJSON.extend({
        addData: function(e) {
            if ("Topology" === e.type)
                for (var t in e.objects)
                    L.GeoJSON.prototype.addData.call(this, topojson.feature(e, e.objects[t]));
            else
                L.GeoJSON.prototype.addData.call(this, e)
        }
    }));
    var Ga = "search-last"
      , Ka = "search-results"
      , Xa = {
        selector: "[data-search]",
        hideClass: "",
        showClass: "",
        transform: "strip",
        change: "words"
    };
    function Ya(e) {
        var l = $.extend({}, Xa, e, this.data());
        return this.off(".g.search").on("keyup.g.search change.g.search", l.selector, t).on("refresh.g.search", s).on("search.g.search", function(e) {
            s(e),
            t(e)
        }),
        this.filter(l.selector).on("keyup.g.search change.g.search", t),
        this;
        function s(e) {
            var t = $.extend({}, l, e.target.dataset)
              , n = "@text" == t.search ? function(e) {
                return e.textContent
            }
            : function(e) {
                return e.getAttribute(t.search)
            }
              , r = Ya.transforms[t.transform]
              , a = $(t.target).map(function() {
                var e = n(this);
                return {
                    el: $(this),
                    original: e,
                    text: r(e),
                    show: !0
                }
            }).get();
            return $(e.target).data(Ka, a).removeData(Ga),
            a
        }
        function t(e) {
            var t = $.extend({}, l, e.target.dataset)
              , n = $(e.target)
              , r = {
                type: "shown.g.search",
                searchText: n.val()
            };
            if (r.search = Ya.changes[t.change](Ya.transforms[t.transform](r.searchText)),
            n.data(Ga) != r.search) {
                n.data(Ga, r.search);
                var a = t.hideClass
                  , o = t.showClass
                  , i = new RegExp(r.search || ".*");
                r.results = n.data(Ka) || s(e),
                r.matches = r.results.length,
                r.results.forEach(function(e) {
                    var t = e.text.match(i);
                    t !== e.show && (a && e.el[t ? "removeClass" : "addClass"](a),
                    o && e.el[t ? "addClass" : "removeClass"](o),
                    e.show = t),
                    t || r.matches--
                }),
                n.trigger(r)
            }
        }
    }
    Ya.transforms = {
        strip: function(e) {
            return (e || "").toLowerCase().replace(/\s+/g, " ").replace(/^ /, "").replace(/ $/, "")
        }
    },
    Ya.changes = {
        words: function(e) {
            return e.replace(/\s+/g, ".*")
        }
    },
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        search: Ya
    });
    var Za = "g1.template.render"
      , eo = "g1.template.compiled"
      , to = "g1.template.prev_created";
    function no(e) {
        return _.chain(e.data()).pickBy(function(e, t) {
            return t.match(/^template/)
        }).mapKeys(function(e, t) {
            return t.replace(/^template/, "").toLowerCase()
        }).value()
    }
    function ro(r, a) {
        var o = this
          , e = (a = a || {}).selector || o.data("selector") || 'script[type="text/html"],template';
        return wa(o, e).each(function() {
            var e = $(this);
            if ("dispose" === r) {
                var t = e.data(to);
                return t && t.remove(),
                e.trigger({
                    type: "template",
                    templatedata: r,
                    target: t
                })
            }
            var n = e.data(Za);
            n ? n(r, a) : _.size(no(e)) ? function t(e, n, r, a) {
                var o = _.pickBy(no(e), function(e) {
                    return !$(e).data(eo)
                });
                return Promise.all(_.map(o, function(e) {
                    return t($(e), n, r, a)
                })).then(function() {
                    return Promise.all(_.union(_.map(o, function(e) {
                        return ao($(e), r, a)
                    }), ao(e, r, a)))
                }).catch(function(e) {
                    console.error(e)
                })
            }(e, o, r, a) : ao(e, r, a)
        }),
        this
    }
    function ao(t, n, r) {
        var a = t.html();
        t.is("script") || (a = _.unescape(a));
        var e = t.attr("src");
        if (e)
            return $.get(e).done(function(e) {
                oo(t, e, n, r)
            }).fail(function(e) {
                n.xhr = e,
                oo(t, a, n, r)
            });
        oo(t, a, n, r)
    }
    function oo(o, i, e, l) {
        var s, t = _.template(i);
        function n(e, t) {
            i = o.data(eo)(e);
            var n = o.data("append") || (t ? t.append : l.append)
              , r = o.data("target") || (t ? t.target : l.target)
              , a = o.data("engine") || (t ? t.engine : l.engine);
            return a && "string" != typeof a || (a = ro.engines[a] || ro.engines.default),
            n ? (s = $($.parseHTML(i.trim())),
            r ? $(r).append(s) : o.before(s)) : (s = a(o, r, i),
            o.data(to, s)),
            o.trigger({
                type: "template",
                templatedata: e,
                target: s
            }),
            s
        }
        return o.data(eo, function(e) {
            return e = _.extend({
                $node: o,
                $data: o.data()
            }, _.mapValues(no(o), function(e) {
                return $(e).data(eo)
            }), e || {}),
            t(e)
        }),
        o.data(Za, n),
        !1 !== o.data("target") ? n(e) : null
    }
    function io(e, n) {
        return e && n && e.length === n.length && e.every(function(e, t) {
            return e === n[t]
        })
    }
    (ro.engines = {}).default = ro.engines.jquery = function(e, t, n) {
        var r = $($.parseHTML(n.trim()));
        if (t)
            $(t).html(r);
        else {
            var a = e.data(to);
            a && a.remove(),
            e.before(r)
        }
        return r
    }
    ,
    ro.engines.vdom = function(e, t, n) {
        var r, a, o;
        if (t = t || e.data(to)) {
            var i = (r = $(t)).get(0);
            a = "<" + i.nodeName,
            $.each(i.attributes, function() {
                a += " " + this.name + "=" + this.value
            }),
            a += ">",
            o = "</" + i.nodeName + ">"
        } else
            a = "<div>",
            o = "</div>",
            r = $(a + o).insertBefore(e);
        return r.each(function() {
            morphdom(this, a + n + o)
        }),
        r
    }
    ,
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        template: ro
    }),
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        urlchange: function() {
            var i, l, s = this, c = s.get(0).location, u = {};
            return s.on("hashchange.urlchange", function() {
                var e = ba(c.hash.replace(/^#/, ""))
                  , t = {}
                  , n = 0;
                for (var r in $.extend({}, e.searchList, u)) {
                    var a = e.searchList[r] || [];
                    if (!io(a, u[r] || [])) {
                        var o = 0 < a.length ? a[0] : "";
                        s.trigger({
                            type: "#?" + r,
                            hash: e,
                            vals: a,
                            old: i
                        }, o),
                        u[r] = t[r] = a,
                        n += 1
                    }
                }
                l != e.pathname && (s.trigger({
                    type: "#/",
                    hash: e,
                    old: i
                }, e.pathname),
                t["/"] = l = e.pathname),
                n && s.trigger({
                    type: "#?",
                    hash: e,
                    change: t,
                    old: i
                }, e),
                $.isEmptyObject(t) || s.trigger({
                    type: "#",
                    hash: e,
                    change: t,
                    old: i
                }, e),
                i = e
            }).trigger("hashchange")
        }
    }),
    "undefined" != typeof jQuery && jQuery.extend(jQuery.fn, {
        translate: function(f) {
            return f = f || {},
            this.each(function() {
                var r = $(this)
                  , e = r.attr("lang") || f.source || ""
                  , t = r.attr("lang-target") || f.target;
                if (!t)
                    throw new Error("$.translate has no target");
                if (t != e) {
                    for (var n, a = [], o = [], i = [], l = document.createTreeWalker(this, NodeFilter.SHOW_TEXT, null, !1); n = l.nextNode(); ) {
                        var s = n.textContent
                          , c = $.trim(s);
                        c && (a.push(n),
                        o.push(s),
                        i.push(c))
                    }
                    var u = {
                        q: i,
                        source: e,
                        target: t
                    };
                    $.ajax({
                        url: r.attr("lang-url") || f.url || "translate",
                        data: u,
                        traditional: !0
                    }).done(function(e) {
                        e.forEach(function(e, t) {
                            e.node = a[t],
                            e.node.textContent = o[t].replace(e.q, e.t)
                        }),
                        r.trigger({
                            type: "translate",
                            translate: e
                        })
                    }).fail(function(e, t, n) {
                        r.trigger({
                            type: "error",
                            request: u,
                            xhr: e
                        }),
                        console.warn("$.translate: error", n)
                    })
                }
            }),
            this
        }
    }),
    e.datafilter = u,
    e.fuzzysearch = function(o, e) {
        var t;
        t = (e = e || {}).keys ? o.map(function(t) {
            return e.keys.map(function(e) {
                return "function" == typeof e ? e(t) : t[e]
            }).join(" ")
        }) : o;
        var i = e.limit || 100
          , l = e.case ? "" : "i"
          , s = e.depth || 10
          , c = e.escape || !0;
        return function(e) {
            var n, r = [], a = t.slice();
            return e = e.replace(/^\s/, "").replace(/\s$/, ""),
            c && (e = e.replace(/[-/\\^$*+?.()|[\]{}]/g, "\\$&")),
            n = new RegExp(e.replace(/\s+/, "\\s+"),l),
            a.forEach(function(e, t) {
                e && n.test(e) && (r.push(o[t]),
                a[t] = "")
            }),
            s <= 1 || r.length >= i ? r.slice(0, i) : (n = new RegExp(e.replace(/\s+/, ".*"),l),
            a.forEach(function(e, t) {
                e && n.test(e) && (r.push(o[t]),
                a[t] = "")
            }),
            s <= 2 || r.length >= i ? r.slice(0, i) : (n = e.split(/\s+/).map(function(e) {
                return new RegExp(e,l)
            }),
            a.forEach(function(t, e) {
                t && n.every(function(e) {
                    return e.test(t)
                }) && (r.push(o[e]),
                a[e] = "")
            }),
            s <= 3 || r.length >= i || (n = e.split(/\s+/).map(function(e) {
                return new RegExp(e.replace(/(.)/g, "$&[\\S]*"),l)
            }),
            a.forEach(function(t, e) {
                t && n.every(function(e) {
                    return e.test(t)
                }) && (r.push(o[e]),
                a[e] = "")
            }),
            n = new RegExp(e.replace(/(.)/g, "$&.*"),l),
            a.forEach(function(e, t) {
                e && n.test(e) && (r.push(o[t]),
                a[t] = "")
            }),
            s <= 4 || r.length),
            r.slice(0, i)))
        }
    }
    ,
    e.sanddance = fa,
    e.scale = ea,
    e.types = g,
    e.url = ka,
    e.version = "0.17.4",
    Object.defineProperty(e, "__esModule", {
        value: !0
    })
});
//# sourceMappingURL=g1.min.js.map
